<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Main template that decides which sub-template to use -->
    <template id="_inout_report_template">
        <t t-call="web.external_layout">
            <div class="page">


                <style>
                    .elegant-table {
                    width: 100%;
                    border-collapse: collapse;
                    margin-top: 20px;
                    }

                    .elegant-table th,
                    .elegant-table td {
                    border: 1px solid #ddd;
                    padding: 8px;
                    text-align: left;
                    }

                    .elegant-table th {
                    background-color: #E6E6FA;
                    color: black;
                    font-weight:bold;
                    text-align:center;
                    }

                    .elegant-table tr:nth-child(even){background-color: #f2f2f2;}

                    .elegant-table tr:hover {background-color: #ddd;}

                    .elegant-table th {
                    padding-top: 12px;
                    padding-bottom: 12px;
                    }
                    h2,h3,h4{
                    text-align:center;
                    }

                    .sum-data {
                    background-color: #E6E6FA;
                    font-weight: bold;
                    border-top: double;
                    margin-top: 10px;
                    border-spacing: 0;
                    }
                </style>
                <h2>أرصدة الأصناف</h2>
                <h4>التاريخ:

                    من
                    <span t-esc="data['date_from']"/>
                    ===

                    إلى

                    <span t-esc="data['date_to']"/>


                </h4>
                <h5 style="text-align:left">
                    تمت الطباعة بواسطة:
                    <span t-esc="user.name"/>
                </h5>
                <table class="elegant-table" style="direction:rtl">

                    <thead>
                        <tr>
                            <th></th>
                            <th></th>
                            <th colspan="3">الرصيد الافتتاحي</th>
                            <th colspan="3">خلال الفترة</th>
                            <th colspan="1">الرصيد الختامي</th>
                        </tr>
                        <tr>
                            <th>كود</th>
                            <th>اسم الصنف</th>
                            <th>إضافة</th>
                            <th>صرف</th>
                            <th>إجمالى</th>

                            <th>إضافة</th>
                            <th>صرف</th>
                            <th>إجمالى</th>
                            <th>الرصيد</th>


                        </tr>
                    </thead>
                    <t t-set="vals" t-value="get_inout_details(data)"/>
                    <tbody>
                        <t t-foreach="vals" t-as="inout">
                            <tr>
                                <td style="text-align:right">
                                    <t t-esc="inout['code']"/>
                                </td>
                                <td style="text-align:right">
                                    <t t-esc="inout['name']"/>
                                </td>
                                <td style="text-align:right">
                                    <t t-esc="'{:,}'.format(inout['qty_in_before_start_date'])"/>

                                </td>
                                <td style="text-align:right">
                                    <t t-esc="'{:,}'.format(inout['qty_out_before_start_date'])"/>

                                </td>
                                <t t-set="total_before"
                                   t-value="inout['qty_in_before_start_date']-inout['qty_out_before_start_date']"/>
                                <td style="text-align:right">
                                    <t t-esc="'{:,}'.format(total_before)"/>
                                </td>

                                <!--                                <td style="text-align:right">-->
                                <!--                                    <t t-esc="'{:,}'.format(inout['qty_out_before_start_date']) if isinstance(inout['qty_out_before_start_date'], int) else '{:,.2f}'.format(inout['qty_out_before_start_date']).rstrip('0').rstrip('.')"/>-->

                                <!--                                </td>-->

                                <td style="text-align:right">
                                    <t t-esc="'{:,}'.format(inout['qty_in'])"/>

                                </td>

                                <td style="text-align:right">
                                    <t t-esc="'{:,}'.format(inout['qty_out'])"/>

                                </td>

                                <t t-set="total_period" t-value="inout['qty_in']-inout['qty_out']"/>

                                <td style="text-align:right">
                                    <t t-esc="'{:,}'.format(total_period)"/>

                                </td>

                                <t t-set="total_final" t-value="total_before-total_period"/>

                                <td style="text-align:right">
                                    <t t-esc="'{:,}'.format(total_final)"/>

                                </td>
                            </tr>


                        </t>
                    </tbody>
                </table>


            </div>
        </t>
    </template>


    <template id="inout_report_template">
        <t t-call="web.html_container">
            <t t-call="az_inventory._inout_report_template"/>
        </t>
    </template>

</odoo>