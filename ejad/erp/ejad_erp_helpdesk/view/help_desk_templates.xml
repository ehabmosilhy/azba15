<?xml version="1.0" encoding="utf-8"?>
<odoo>
<!--    <template id="assets_backend" name="add sub type ticket js" inherit_id="web.assets_frontend">-->
<!--        <xpath expr="//link[last()]" position="after">-->
<!--            <link rel="stylesheet" href="/ejad_erp_helpdesk/static/src/scss/custom.scss"/>-->
<!--        </xpath>-->
<!--        <xpath expr="." position="inside">-->
<!--            <script type="text/javascript" src="/ejad_erp_helpdesk/static/src/js/sub_ticket_type.js"></script>-->
<!--        </xpath>-->
<!--    </template>-->
    <template id="sub_ticket_type_submit" name="Helpdesk: Submit a Ticket with type and sub type" inherit_id="website_helpdesk_form.ticket_submit_form" priority="30">
        <xpath expr="//*[@id='forms']" position="attributes">
            <attribute name="class">helpdesk-forms row justify-content-center</attribute>
        </xpath>
<!--        <xpath expr="//form" position="before">-->
<!--            <div class="col-sm-5">-->
<!--                <lottie-player autoplay="true" src="/ejad_erp_helpdesk/static/src/img/Completing-form-banner.json"-->
<!--                               loop="" speed="1" background="transparent"-->
<!--                               style="height: 100%; background: transparent;"></lottie-player>-->
<!--                <script src="/ejad_erp_helpdesk/static/src/js/lottie-player.js"></script>-->
<!--            </div>-->
<!--        </xpath>-->
        <xpath expr="//form" position="attributes">
            <attribute name="class">col-sm-9 s_website_form o_fake_not_editable</attribute>
        </xpath>

        <!-- add phone number       -->
        <xpath expr="//form/div/div[2]" position="after">
            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
            <div class="form-group row form-field o_website_form_custom o_website_form_required_custom">
                <div class="col-lg-3 col-md-4">
                    <label for="personal_id" class="col-form-label">Your National ID</label>
                </div>
                <div class="col-lg-7 col-md-8">
                    <input type="text" class="form-control o_website_form_input" name="personal_id" required=""/>
                </div>
            </div>
            <div class="form-group row form-field o_website_form_custom">
                <div class="col-lg-3 col-md-4">
                    <label for="mobile" class="col-form-label">Your Mobile</label>
                </div>
                <div class="col-lg-7 col-md-8">
                    <input type="text" class="form-control o_website_form_input" name="mobile"/>
                </div>
            </div>
        </xpath>
        <xpath expr="//form/div/div[1]" position="before">
            <!--            add ticket type-->
            <div class="form-group row form-field o_website_form_required">
                <div class="col-lg-3 col-md-4 text-right">
                    <label class="col-form-label" for="ticket_type_id">Type</label>
                </div>
                <div class="col-lg-7 col-md-8">
                    <select type="text" class="form-control o_website_form_input" id="ticket_type_id"
                            name="ticket_type_id" readonly="1">
                        <!--                        <option value=""></option>-->
                        <!--                        <t t-foreach="default_values['ticket_types']" t-as="type">-->
                        <option t-att-value="default_values['ticket_type_id']">
                            <t t-esc="default_values['ticket_type_name']"/>
                        </option>
                        <!--                        </t>-->
                    </select>
                </div>
            </div>
            <!--            add sub ticket type-->
            <!--            <div class="form-group row form-field" id="ticket_type_line_div"></div>-->
            <t t-if="default_values.get('sub_ticket_type_id', False)">
                <div class="form-group row form-field o_website_form_required">
                    <div class="col-lg-3 col-md-4 text-right">
                        <label class="col-form-label" for="ticket_type_line_id">Sub Type</label>
                    </div>
                    <div class="col-lg-7 col-md-8">
                        <select type="text" class="form-control o_website_form_input" id="ticket_type_line_id"
                                name="ticket_type_line_id" readonly="1">
                            <!--                        <option value=""></option>-->
                            <!--                        <t t-foreach="default_values['ticket_types']" t-as="type">-->
                            <option t-att-value="default_values['sub_ticket_type_id']">
                                <t t-esc="default_values['sub_ticket_type_name']"/>
                            </option>
                            <!--                        </t>-->
                        </select>
                    </div>
                </div>
            </t>
        </xpath>
    </template>

    <!--    to make ticket_type_id is form whitelist field-->
    <function model="ir.model.fields" name="formbuilder_whitelist">
        <value>helpdesk.ticket</value>
        <value eval="['ticket_type_id','ticket_type_line_id','mobile', 'personal_id']"/>
    </function>

    <!-- Page : default team with TicketType and SubTicketType -->
    <template id="team_with_ticket_type" name="Helpdesk Team With Ticket Type">
<!--        <t t-call="website.layout" t-lang="request.env.user.partner_id.lang">-->
            <t t-set="additional_title">Ticket</t>
            <div id="wrap" class="oe_structure oe_empt">
                <div class="container">
                    <div class="row">
                        <section class="helpdesk-forms" id="forms">
                            <div class="row justify-content-center">
<!--                                <div class="col-sm-5">-->
<!--                                    <lottie-player autoplay="true" src="/ejad_erp_helpdesk/static/src/img/Helpdesk-banner.json"-->
<!--                                                   loop="" speed="1" background="transparent"-->
<!--                                                   style="height: 100%; background: transparent;"></lottie-player>-->
<!--                                    <script src="/ejad_erp_helpdesk/static/src/js/lottie-player.js"></script>-->
<!--                                </div>-->
                                <div class="col-sm-8">
                                    <form id="ticket_type_form" action="/helpdesk/submit" method="post"
                                          class="form s_website_form container-fluid mt32 o_fake_not_editable">
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                        <div class="form-group form-field">
                                            <h2>Type</h2>
                                            <select type="text" class="custom-select form-control o_website_form_input"
                                                    id="ticket_type_id"
                                                    name="ticket_type_id" required="1">
                                                <option value=""></option>
                                                <t t-foreach="default_values['ticket_types']" t-as="type">
                                                    <option t-att-value="type.id">
                                                        <t t-esc="type.name"/>
                                                    </option>
                                                </t>
                                            </select>
                                        </div>
                                        <div class="form-group form-field" id="ticket_type_line_div"></div>
                                        <div class="form-group form-field d-none">
                                            <label for="team_id">Team</label>
                                            <input type="hidden" class="form-control o_website_form_input"
                                                   name="team_id" t-att-value="team.id"/>
                                        </div>
<!--                                        <input class="btn btn-success" type="submit" value="Submit"/>-->
                                        <button type="submit" class="btn btn-primary" value="Submit">Submit</button>
                                    </form>
                                </div>
                            </div> <!-- End Row -->
                        </section>
                    </div>
                </div>
            </div>
<!--        </t>-->
    </template>

    <!--    xpath for change submit to ticket btn change href to another template-->
    <template id="website_helpdesk_form.website_helpdesk_form_team" name="Website Helpdesk Form Team" inherit_id="website_helpdesk.team">
        <xpath expr="//div[@id='website_helpdesk_form']" position="replace">
            <div t-if="team.use_website_helpdesk_form">
            </div>
        </xpath>
    </template>
    <template id="submit_to_ticket_btn" name="change submit to ticket btn"
              inherit_id="website_helpdesk.team" priority="30">
        <xpath expr="//t[@t-if='team.use_website_helpdesk_form']" position="before">
            <div class="btn-group btn-block mb16">
                <a id="submit-ticket2" t-attf-href="/helpdesk/#{team.id}/tickettype">
                    <button t-attf-class="btn btn-primary #{'col-md-10' if multi_type else 'col-md-12'}">Submit a Ticket
                    </button>
                </a>
            </div>
        </xpath>
        <!--add link button to query the status of ticket bt id and phone number-->
        <xpath expr="//div[@id='oe_structure_website_helpdesk_team_2']" position="after">
            <t t-if="team.use_website_helpdesk_form">
                <div class="btn-group btn-block mb16" style="margin-top: 2em">
                    <a id="query-ticket" t-attf-href="/helpdesk/query_ticket">
                        <button t-attf-class="btn btn-primary #{'col-md-10' if multi_type else 'col-md-12'}">Query a
                            Ticket
                        </button>
                    </a>
                </div>
            </t>
        </xpath>
    </template>

    <!-- Page : query ticket form -->
    <template id="user_query_ticket" name="User Query Ticket">
        <t t-call="website.layout">
            <t t-set="additional_title">Query Ticket</t>
            <div id="wrap" class="oe_structure oe_empt">
                <div class="container">
                    <div class="row">
                        <section class="helpdesk-forms" id="forms">
                            <div class="row justify-content-center">
                                <div class="col-sm-7">
                                    <form id="query_ticket_form" action="/helpdesk/ticket_status" method="post"
                                          class="form s_website_form container-fluid mt32 o_fake_not_editable">
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                        <div class="messages">
                                            <div t-if="error" class="alert alert-danger in show">
                                                <i class="fa fa-times-circle"></i>
                                                <h4 class="alert-heading">
                                                    <t t-esc="error"/>
                                                </h4>

                                            </div>
                                        </div>
<!--                                        <div class="form-group form-field">-->
<!--                                            <label for="ticket_id">Ticket No</label>-->
<!--                                                <input id="query_ticket_id" type="text" class="form-control o_website_form_input" name="ticket_id" required="1"/>-->
<!--                                        </div>-->
<!--                                        <div class="form-group form-field" id="ticket_type_line_div"></div>-->
                                        <div class="form-group form-field">
                                            <label for="user_mobile" class="col-form-label">Personal ID/Commercial No</label>
                                            <input type="text" class="form-control o_website_form_input" name="user_mobile" required="1"/>
                                        </div>
<!--                                        <input id="submit_btn_ticket_id" class="btn btn-success" type="submit" value="Submit"/>-->
                                        <button id="submit_btn_ticket_id" type="submit" class="btn btn-primary" value="Submit">Submit</button>
                                    </form>
                                </div>
                            </div> <!-- End Row -->
                        </section>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Page : ticket status data -->
    <template id="user_query_ticket_status" name="User Query Ticket Status">
        <t t-call="website.layout">
            <t t-set="additional_title">Ticket Status</t>
            <div id="wrap" class="oe_structure oe_empt">
                <section class="ticket-status">
                    <div class="container">
                        <!-- <div class="banner">
                            <lottie-player autoplay="true" src="/ejad_erp_helpdesk/static/src/img/status.json"
                                           loop="" speed="1" background="transparent"
                                           style="height: 100%; background: transparent;"></lottie-player>
                            <script src="/ejad_erp_helpdesk/static/src/js/lottie-player.js"></script>
                        </div> -->
                        <div class="row">
                            <t t-foreach="ticket.sorted(lambda line: line.id)" t-as="o">
                                <div class="col-sm-6">
                                    <div class="item">
                                        <div class="row">
                                            <div class="col-6">
                                                <h6><i class="fad fa-hashtag"></i> Ticket No:</h6>
                                            </div>
                                            <div class="col-6">
                                                <h5 t-att-value="o.id">
                                                    <t t-esc="o.id"/>
                                                </h5>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6">
                                                <h6><i class="fad fa-ticket"></i> Ticket Name:</h6>
                                            </div>
                                            <div class="col-6">
                                                <p t-att-value="o.name">
                                                    <t t-esc="o.name"/>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6">
                                                <h6><i class="fad fa-spinner"></i> Ticket Status:</h6>
                                            </div>
                                            <div class="col-6">
                                                <p t-att-value="o.stage_id.name">
                                                    <t t-esc="o.stage_id.name"/>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <t t-if="o.replay_partner">
                                                  <div class="col-6">
                                                    <h6> Replay to Ticket:</h6>
                                                </div>
                                                <div class="col-6">
                                                    <p t-att-value="o.replay_partner">
                                                        <t t-esc="o.replay_partner"/>
                                                    </p>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </div>
                            </t>
                        </div>
                    </div>
                </section>
            </div>
        </t>
    </template>
<!--    translations-->
    <template id="translate_team_with_ticket_type" name="Choose Ticket Type">
        <t t-call="website.layout">
                <t t-set="additional_title">Choose Ticket Type</t>
<!--            <t t-foreach="docs" t-as="o">-->
<!--                <t t-set="lang" t-value="request.env.user.partner_id.lang"/>-->
                <t t-call="ejad_erp_helpdesk.team_with_ticket_type" t-lang="lang"/>
<!--            </t>-->
        </t>
    </template>

</odoo>