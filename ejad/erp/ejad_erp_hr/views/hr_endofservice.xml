<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="view_endofservice_tree" model="ir.ui.view">
            <field name="name">view.endofservice.tree</field>
            <field name="model">hr.end.service</field>
            <field name="arch" type="xml">
                <tree string="End Of Service">
                    <field name="name"/>
                    <field name="employee_id"/>
                    <field name="identification_id"/>
                    <field name="department_id"/>
                    <field name="job_id"/>
                    <field name="grade_id"/>
                    <field name="contract_type"/>
                    <field name="date_start"/>
                    <field name="date_end"/>
                    <field name="date_benefit"/>
                    <field name="benefits"/>
                    <field name="responsible"/>
                    <field name="state"/>

                </tree>
            </field>
        </record>


        <record id="view_endofservice_form" model="ir.ui.view">
            <field name="name">view.endofservice.form</field>
            <field name="model">hr.end.service</field>
            <field name="arch" type="xml">
                <form string="طلب نهاية الخدمة">
                    <field name="require_general_director_approve" invisible="1"/>
                    <header>

                        <button name="workflow_next" string="Accept"
                            attrs="{'invisible':[('is_workflow_next_allowed', '=', False)]}"
                            type="object"
                            class="oe_highlight reload_page_js"/>

                        <button name="workflow_previous" string="Previous Stage"
                            attrs="{'invisible':[('is_workflow_previous_allowed', '=', False)]}"
                            type="object"
                            class="oe_highlight reload_page_js"/>

                        <button name="%(endofservice_refuse_wizard_action)d"
                            string="Cancel"
                            attrs="{'invisible':[('is_refuse_action_allowed', '=', False)]}"
                            type="action"/>


                        <field name="stage_id" widget="statusbar"  domain="[('id', 'in', related_stages)]"/>

    <!--                <div attrs="{'invisible':['|',('stage_id','=',False),('have_secondary_stage','=',False)]}">-->
    <!--                    <field name="current_second_stage" widget="statusbar" domain="[('id', 'in', related_secondary_stages)]"/>-->
    <!--                </div>-->

                        <group invisible="1">
                            <field name="is_workflow_next_allowed" invisible="1"/>
                            <field name="related_stages" invisible="1"/>
                            <field name="have_secondary_stage" invisible="1"/>
                            <field name="related_secondary_stages" invisible="1"/>
                            <field name="state" invisible="1"/>
                            <field name="is_workflow_previous_allowed" invisible="1"/>
                            <field name="is_refuse_action_allowed" invisible="1"/>
                            <field name="is_return_action_allowed" invisible="1"/>
                        </group>


<!--                        <field name="state" widget="statusbar"-->
<!--                               statusbar_visible="draft,employee_request,approved_by_direct_manger,approved_by_hr,accountant,financial_auditor,financial_manager,financial_monitor,admin_financial_manager,benefits_paid"/>-->

<!--                        <button name="button_employee_send_request"-->
<!--                                string="Apply Request" type="object" states="draft" class="oe_highlight"/>-->

<!--                        <button name="button_approved_by_hr" states="employee_request"-->
<!--                                string="Confirm HR" groups="hr.group_hr_user" type="object"-->
<!--                                class="oe_highlight"/>-->


<!--                        <button name="button_accountant" states="approved_by_hr"-->
<!--                                string="Confirm Accountant" type="object"-->
<!--                                class="oe_highlight" groups="ejad_erp_hr.group_accountant"/>-->
<!--                        <button name="button_financial_auditor" states="accountant"-->
<!--                                string="Confirm Financial Auditor" type="object"-->
<!--                                class="oe_highlight" groups="ejad_erp_hr.group_financial_auditor"/>-->
<!--                        <button name="button_financial_manager" states="financial_auditor"-->
<!--                                string="Confirm Financial Manager" type="object"-->
<!--                                class="oe_highlight" groups="ejad_erp_hr.group_financial_manager"/>-->
<!--                        <button name="button_financial_monitor" states="financial_manager"-->
<!--                                string="Confirm Financial Monitor" type="object"-->
<!--                                class="oe_highlight" groups="ejad_erp_hr.group_financial_monitor"/>-->
<!--                        <button name="button_admin_financial_manager" states="financial_monitor"-->
<!--                                string="Confirm Admin/Financial Manager" type="object"-->
<!--                                class="oe_highlight" groups="ejad_erp_hr.group_admin_financial_manager"/>-->

<!--                        <button name="button_general_director_approve"-->
<!--                                attrs="{'invisible': ['|',-->
<!--                                ('require_general_director_approve', '=', False),-->
<!--                                ('state', '!=', 'admin_financial_manager')]}"-->

<!--                                string="General director approve" type="object"-->
<!--                                class="oe_highlight" groups="ejad_erp_base.group_general_director"/>-->

                        <button name="%(action_endofservice_wizard)d"
                                type="action"
                                groups="ejad_erp_hr.group_endservice_payment_register"
                                string="Benefits Payment"
                                attrs="{'invisible':['|', '&amp;',
                                ('require_general_director_approve', '=', True), ('state', '!=', 'general_director_approve'),
                                 '&amp;',
                                ('require_general_director_approve', '=', False), ('state', '!=', 'admin_financial_manager')]}"
                                class="oe_stat_button oe_highlight"
                                context="{'default_end_request_id': active_id, 'default_journal_id': journal_id}"

                        />
                        <button name="%(ejad_erp_account.action_payment_order_report_wizard)d"
                                type="action"
                                string="طباعة أمر الصرف"
                                class="oe_stat_button oe_highlight"
                                attrs="{'invisible':[('move_id','=',False)]}"
                                context="{
									'default_move_id': move_id,
									'default_payment_name': name,


								}"
                        />

<!--                        <button name="button_cancel"-->
<!--                                string="Cancel Request" type="object"-->
<!--                                class="oe_highlight"-->
<!--                                attrs="{'invisible': [('state', 'in', ['benefits_paid','cancel'])]}"-->
<!--                        />-->

<!--                        <button name="button_draft"-->
<!--                                string="Return to Draft" type="object"-->
<!--                                class="oe_highlight"-->
<!--                                attrs="{'invisible': [('state', 'not in', ['cancel'])]}"-->
<!--                        />-->
                        <button name="%(endofservice_return_wizard_action)d" string="Return to Draft"
                            attrs="{'invisible':[('is_return_action_allowed', '=', False)]}"
                            type="action"
                            class="oe_highlight"
                        />
                        <button name="%(action_bank_letter_wizard)d"
                                type="action"
                                groups="ejad_erp_hr.group_end_service_bank_letter"
                                string="خطاب البنك"
                                attrs="{'invisible':['|', '&amp;',
                                ('require_general_director_approve', '=', True), ('state', '=', 'admin_financial_manager'),
                                ('state', 'not in', ['general_director_approve','benefits_paid','admin_financial_manager'])]}"
                                class="oe_stat_button oe_highlight"
                                context="{
									'default_employee_id': employee_id,
									'default_amount': benefits,
									'default_journal_id': journal_id,

								}"
                        />


                    </header>
                    <sheet>
                        <h3>
                            <field name="name"></field>
                        </h3>
                        <group>
                            <group string="Employee Information">
                                <field name="employee_id" options="{'no_create': True,'no_open':True}" required="1" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="department_id" options="{'no_create': True,'no_open':True}" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="job_id" options="{'no_create': True,'no_open':True}" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>

                                <field name="identification_id" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                            </group>
                            <group string="Employee Contract information">
                                <field name="grade_id" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="grade_level_id" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="contract_type" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="date_start" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="date_end" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="date_benefit" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="end_service_months" invisible="1" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="ens_months_c" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                                <field name="salary" invisible="1"/>
                                <field name="move_id" invisible="1"/>
                                <field name="responsible" readonly="1" options="{'no_create': True,'no_open':True}"/>


                            </group>

                            <group string="مبلغ الاستحقاق">
                                <field name="benefits" attrs="{'readonly':[('state','not in',['draft','employee_request'])]}"/>
                            </group>

                        </group>
                        <group>
                            <group string="تفاصيل السداد">
                                <field name="payment_type2" widget="radio" attrs="{'readonly':[('state','not in',['approved_by_hr','accountant'])]}"/>
                                <field name="journal_id" widget="selection" attrs="{'readonly':[('state','not in',['approved_by_hr','accountant'])]}"/>
                                <field name="treasury_account_id" readonly="1"  options="{'no_create': True,'no_open':True}"/>
                                <field name="benefit_account_id" readonly="1"  options="{'no_create': True,'no_open':True}"/>
                                <field name="bank_ref" attrs="{'readonly':[('state','not in',['approved_by_hr','accountant'])]}"/>
                                <field name="cash_ref_seq" invisible="1"/>
                                <field name="bank_ref_seq" invisible="1"/>
                                <field name="bank_check_no" attrs="{'readonly':[('state','not in',['approved_by_hr','accountant'])]}"/>

                            </group>
                        </group>


                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="action_endofservice" model="ir.actions.act_window">
            <field name="name">End Of Service</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.end.service</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    مكافئات نهايه الخدمة
                </p>
                <p>
                    انشاء استمارات نهاية الخدمة للموظفين
                </p>
            </field>
        </record>

        <!-- This Menu Item Must have a parent -->
        <menuitem id="menu_end_categ" name="نهاية الخدمة" parent="hr.menu_hr_root" sequence="11"/>
        <!-- This Menu Item must have a parent and an action -->
        <menuitem id="menu_endservice_action" name="طلب مكافئه نهاية الخدمة" parent="menu_end_categ"
                  action="action_endofservice" sequence="1" groups="ejad_erp_hr.hr_end_service_menu"/>

    </data>
</odoo>