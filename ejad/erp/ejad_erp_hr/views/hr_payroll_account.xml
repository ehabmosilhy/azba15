<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>


        <record id="act_hr_payroll_advice_request" model="ir.actions.act_window">
            <field name="name">Payroll Payment</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.payroll.advice</field>
            <field name="binding_model_id" ref="model_hr_payslip_run"/>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_batch_id_id': [active_id], 'default_batch_id': active_id}</field>
            <field name="domain">[('batch_id','=',active_id)]</field>
            <!--         <field name="view_id" eval="view_hr_bank_advice_tree"/>
             -->
        </record>


        <record id="hr_payslip_run_form" model="ir.ui.view">
            <field name="name">hr.payslip.run.form</field>
            <field name="model">hr.payslip.run</field>
            <field name="inherit_id" ref="hr_payroll.hr_payslip_run_form"/>
            <field name="arch" type="xml">


                <xpath expr="//sheet" position="inside">
                    <div class="oe_button_box" name="button_box">

                        <button name="%(act_hr_payroll_advice_request)d"
                                type="action"
                                class="oe_stat_button"
                                icon="fa-calendar">
                            <field name="advice_count" widget="statinfo" string="Payroll payment"/>
                        </button>
                    </div>
                    <!--                                     groups="hr.group_hr_manager,hr.group_hr_user"
                     -->
                    <notebook>
                        <page string="Payslips">
                            <field name="slip_ids"/>
                        </page>
                        <page string="Total Salarys">
                            <group>
                                <field name="journal_total_id"/>
                                <field name="move_id"/>
                            </group>
                            <field name="total_salary_ids">
                                <tree>
                                    <field name="rule_id"/>
                                    <field name="amount"/>
                                </tree>
                            </field>
                        </page>
                        <!--             <page string="Payslips Advise">
                                        <field name="advice_ids">
                                            <tree editable="bottom" create="0">
                                                <field name="name"/>
                                                <field name="date"/>
                                                <field name="bank_id"/>
                                                <field name="total_amount"/>
                                            </tree>
                                        </field>
                                    </page> -->
                    </notebook>
                </xpath>
                <field name="state" position="replace">
                    <field name="state" widget="statusbar"
                           statusbar_visible="draft_prepare,waiting_approval_1,waiting_approval_2,waiting_approval_3,waiting_approval_4,waiting_approval_5,waiting_approval_6,waiting_approval_7,close"/>

                </field>
                <field name="date_start" position="replace">
                    <field name="date_start" class="oe_inline"
                           attrs="{'readonly':[('state','!=','draft_prepare')]}"/>
                </field>
                <field name="date_end" position="replace">
                    <field name="date_end" class="oe_inline"
                           attrs="{'readonly':[('state','!=','draft_prepare')]}"/>
                </field>
                <field name="credit_note" position="replace">
                    <field name="credit_note" attrs="{'readonly':[('state','!=','draft_prepare')]}"/>
                </field>
                <field name="name" position="replace">
                    <field name="name" attrs="{'readonly':[('state','!=','draft_prepare')]}"/>
                </field>
                <xpath expr="//notebook/page[1]/field[@name='slip_ids']" position='replace'>
                    <field name="slip_ids" attrs="{'readonly':[('state','!=','draft_prepare')]}"/>
                </xpath>
                <xpath expr="//header" position="inside">
                    <field name="require_general_director_approve" invisible="1"/>

                    <button name="action_waiting_approval_1" type="object" string=" تأكيد أخصائي الموارد البشرية"
                            states="draft_prepare" class="oe_highlight" groups="ejad_erp_hr.access_waiting_approval_1"/>
                    <button name="action_waiting_approval_2" class="oe_highlight" type="object"
                            string="تأكيد مدراء الوحدات الإدارية"
                            states="waiting_approval_1" groups="ejad_erp_hr.access_waiting_approval_2"/>
                    <button name="action_waiting_approval_3" class="oe_highlight" type="object"
                            string="موافقة مدير إدارة الخدمات المساندة"
                            states="waiting_approval_2" groups="ejad_erp_hr.access_waiting_approval_3"/>
                    <button name="close_payslip_run" class="oe_highlight" type="object" string=" اعتماد قائد المكتب"
                            states="waiting_approval_3" groups="ejad_erp_hr.access_waiting_approval_4"/>
                    <button name="action_return_draft" type="object"
                            string="إرجاع إلى مسودة"
                            attrs="{'invisible': [
                                ('state', 'in', ['draft_prepare','close'])]}"
                            groups="ejad_erp_hr.group_return_payslip_batch_draft"/>

                    <!--<button name="button_general_director_approve"-->
                    <!--attrs="{'invisible': ['|',-->
                    <!--('require_general_director_approve', '=', False),-->
                    <!--('state', '!=', 'waiting_approval_7')]}"-->

                    <!--string="General director approve" type="object"-->
                    <!--class="oe_highlight" groups="ejad_erp_base.group_general_director"/>-->

                    <!--<button name="close_payslip_run" type="object" string="Close"-->
                    <!--attrs="{'invisible':['|', '&amp;',-->
                    <!--('require_general_director_approve', '=', True), ('state', '!=', 'general_director_approve'),-->
                    <!--'&amp;',-->
                    <!--('require_general_director_approve', '=', False), ('state', '!=', 'waiting_approval_7')]}"-->

                    <!--class="oe_highlight" groups="ejad_erp_hr.access_close_payslip_run"/>-->
                    <button type="object" name="compute_total_line" string="Compute Total"
                            icon="terp-stock_format-scientific" colspan="2"
                            states="waiting_approval_1,waiting_approval_2"
                            groups="ejad_erp_hr.access_compute_total_line"/>

                    <!--<button name="generate_advice" string="Create Advice" type="object" />-->
                    <!--           <button name="action_pay" string="Create journal" type="object" states="waiting_approval_7" />


                     -->
                    <button name="%(wizard_payroll_excel_export_action)d" string="تصدير الرواتب إلى اكسل" widget="radio"
                            type="action" context="{'default_payslip_batch_id': active_id}"
                            groups="ejad_erp_hr.group_export_payroll_excel"/>

                    <button name="%(wizard_payroll_excel_export_action)d" string="تصدير الرواتب إلى اكسل" widget="radio"
                            type="action" context="{'default_payslip_batch_id': active_id}"
                            groups="ejad_erp_hr.group_export_payroll_excel1"
                            states="waiting_approval_2,waiting_approval_3,waiting_approval_4,waiting_approval_5,waiting_approval_6,waiting_approval_7,close,general_director_approve"/>

                </xpath>
                <xpath expr="//header/button[@name='action_draft']" position="replace">
                </xpath>

                <button name="%(hr_payroll.action_hr_payslip_by_employees)d" type="action" states="draft"
                        position="replace">
                    <button name="%(hr_payroll.action_hr_payslip_by_employees)d" string="Generate Payslips"
                            type="action" states="draft_prepare" groups="ejad_erp_hr.access_generate_payslip"/>
                    <button name="recompute_payslips" string="اعادة احتساب" type="object" states="draft_prepare"
                            groups="ejad_erp_hr.access_generate_payslip"/>
                </button>

                <field name="credit_note" position="after">
                    <field name="is_advance_salary" attrs="{'readonly':[('state','!=','draft_prepare')]}"/>
                </field>
                <xpath expr="//form" position="inside">
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </xpath>


            </field>
        </record>


        <record id="hr_salary_rule_form_inherit" model="ir.ui.view">
            <field name="name">hr.salary.rule.form.inherit</field>
            <field name="model">hr.salary.rule</field>
            <field name="inherit_id" ref="hr_payroll.hr_salary_rule_form"/>
            <field name="arch" type="xml">

                <xpath expr="//notebook/page[@name='general']" position="after">
                    <page string="Total salarys config">
                        <group colspan="4"
                               string="This Config for to janaret one eintrys for all Employes on payslip batch  to print or generate a pdf of your payslip batch">
                            <field name="account_debit_total"/>
                            <field name="account_credit_total"/>
                            <field name="advance_account_debit_total"/>
                            <field name="advance_account_credit_total"/>
                            <field name="is_net"/>
                            <field name="is_export_excel"/>
                        </group>
                    </page>
                </xpath>

            </field>
        </record>


    </data>
</odoo>