<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <record id="view_partner_bank_form" model="ir.ui.view">
        <field name="name">res.partner.bank.form</field>
        <field name="model">res.partner.bank</field>
        <field name="inherit_id" ref="base.view_partner_bank_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='acc_number']/.." position="before">
                <div class="label label-danger pull-left" attrs="{'invisible': [('has_char','!=',True)]}">
                    <span>رقم الحساب يحتوي على حروف</span>
                </div>
            </xpath>
            <field name="bank_id" position="after">
                <field name="has_char" invisible="1"/>
                <field name="account_type"/>
                <field name="additional_info" attrs="{'invisible':[('account_type','!=','external')]}"/>
            </field>
        </field>
    </record>

    <record id="view_partner_bank_tree" model="ir.ui.view">
        <field name="name">res.partner.bank.tree</field>
        <field name="model">res.partner.bank</field>
        <field name="inherit_id" ref="base.view_partner_bank_tree"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <field name="account_type"/>
                <field name="additional_info"/>
            </field>
        </field>
    </record>

    <record id="view_department_tree_inheritance" model="ir.ui.view">
        <field name="name">hr.r.department.form.grade.rank</field>
        <field name="model">hr.department</field>
        <field name="inherit_id" ref="hr.view_department_tree"/>
        <field name="arch" type="xml">
            <field name="parent_id" position="before">
                <field name="code"/>
                <field name="type"/>
            </field>
        </field>
    </record>


    <!-- EMPLOYEES INHERITED FORM VIEW -->
    <record id="view_employee_form_grade_rank" model="ir.ui.view">
        <field name="name">hr.employee.form.grade.rank</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.view_employee_form"/>
        <field name="arch" type="xml">

            <xpath expr="//field[@name='bank_account_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>
            </xpath>

            <xpath expr="//field[@name='user_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>
            </xpath>


            <xpath expr="//field[@name='address_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>
            </xpath>

            <xpath expr="//field[@name='resource_calendar_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>
            </xpath>

            <xpath expr="//field[@name='department_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>
            </xpath>

            <xpath expr="//field[@name='job_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>

            </xpath>
            <field name="job_id" position="after">
                <field name="contract_type"/>
                <field name="emp_type"/>
                <!--                 <field name="grade_id" readonly="1"/>
                                <field name="grade_level_id" readonly="1" /> -->
            </field>
            <field name="department_id" position="after">
                <field name="department_id2" options="{'no_create': True,'no_open':True}"/>
            </field>
            <field name="name" position="after">
                -
                <field name="en_name" nolabel="1" placeholder="English Name"/>
            </field>
            <field name="bank_account_id" position="before">
                <field name="payment_type"/>
            </field>


            <field name="address_home_id" position="before">
                <field name="private_phone"/>
                <field name="private_email"/>
            </field>
            <field name="user_id" position="before">
                <field name="date_of_join"/>
                <field name="secondment_date"/>
                <field name="contract_date"/>
                <field name="cooperation_date"/>
                <field name="hiring_date"/>
                <field name="date_grade_update"/>
                <field name="ens_months" invisible="1"/>
                <field name="has_gosi"/>
                <field name="has_saned"/>
                <field name="loans_count" readonly="1" string="عدد القروض السابقة"/>
            </field>
<!--todo : mirgration 15-->
            <xpath expr="//group[@name='has_work_permit']" position="after">
                <group string="Qualifications">
                    <field name="qualification" options="{'no_create': True,'no_open':True}"/>
                    <field name="major" options="{'no_create': True,'no_open':True}"/>
                    <field name="graduation_year"/>
                </group>
            </xpath>
            <xpath expr="//field[@name='parent_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>

            </xpath>
            <xpath expr="//notebook/page[@name='hr_settings']" position="after">
                <page string="المرفقات" groups="ejad_erp_hr.group_hr_employees_attachments">
                    <field name="attachment_ids" groups="ejad_erp_hr.group_hr_employees_attachments">
                        <tree editable="top">
                            <field name="name"/>
                            <field name="attachment_filename" invisible="1"/>
                            <field widget="binary" name="attachment_id" filename="attachment_filename"/>
                        </tree>
                        <form>
                            <group>
                                <field name="name"/>
                                <field name="attachment_filename" invisible="1"/>
                                <field widget="binary" name="attachment_id" filename="attachment_filename"/>
                            </group>
                        </form>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

    <!-- EMPLOYEES INHERITED TREE VIEW -->
    <record id="view_employee_tree_grade_rank" model="ir.ui.view">
        <field name="name">hr.employee.tree.grade.rank</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.view_employee_tree"/>
        <field name="arch" type="xml">
            <field name="name" position="after">
                <field name="emp_attendance_no"/>
            </field>
        </field>
    </record>

    <!-- EMPLOYEES INHERITED SEARCH VIEW -->
    <record id="view_employee_filter_grade_rank" model="ir.ui.view">
        <field name="name">Employees Grade Rank</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.view_employee_filter"/>
        <field name="arch" type="xml">
            <field name="name" position="replace">
                <field name="name" string="Employees"
                       filter_domain="['|','|',('work_email','ilike',self),('en_name','ilike',self),('name','ilike',self)]"/>
                <field name="emp_attendance_no"/>
            </field>

        </field>
    </record>

    <record id="view_department_filter" model="ir.ui.view">
        <field name="name">hr.department.search</field>
        <field name="model">hr.department</field>
        <field name="inherit_id" ref="hr.view_department_filter"/>
        <field name="arch" type="xml">
            <field name="name" position="replace">
                <field name="name" filter_domain="['|',('name','ilike',self),('complete_name','ilike',self)]"/>
                <field name="code"/>
            </field>

        </field>
    </record>

    <record id="hr_contract_view_tree1" model="ir.ui.view">
        <field name="name">hr.contract.tree</field>
        <field name="model">hr.contract</field>
        <field name="inherit_id" ref="hr_contract.hr_contract_view_tree"/>
        <field name="arch" type="xml">
            <field name="employee_id" position="after">
                <field name="emp_attendance_no" string="رقم الموظف"/>
            </field>
        </field>
    </record>

    <!-- EMPLOYEES INHERITED KANBAN VIEW -->
    <record id="hr_kanban_view_emp_no" model="ir.ui.view">
        <field name="name">hr.employee.kanban.grade.employee_no</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.hr_kanban_view_employees"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="after">
                <li t-if="record.emp_attendance_no and record.emp_attendance_no != 0">
                    <field name="emp_attendance_no"/>
                </li>
            </xpath>
        </field>
    </record>

    <record id="hr_contract_view_kanban_emp" model="ir.ui.view">
        <field name="name">hr.contract.employee_no</field>
        <field name="model">hr.contract</field>
        <field name="inherit_id" ref="hr_contract.hr_contract_view_kanban"/>
        <field name="arch" type="xml">
            <xpath expr="//templates" position="before">
                <field name="employee_id"/>
            </xpath>

            <xpath expr="//field[@name='name']" position="after">
                <ul>
                    <li t-if="record.employee_id.raw_value">
                        <field name="employee_id"/>
                    </li>
                    <li t-if="record.emp_attendance_no and record.emp_attendance_no != 0">
                        <field name="emp_attendance_no"/>
                    </li>
                </ul>
            </xpath>


        </field>
    </record>

    <record id="hr_employee_salary_letter_view" model="ir.ui.view">
        <field name="name">hr.employee.salary.letter.view</field>
        <field name="model">hr.employee.salary.letter</field>
        <field name="arch" type="xml">
            <form string="Salary Letter">
                <sheet>
                    <group>
                        <group>
                            <field name="contract_id" required="1" invisible="1"
                                   options="{'no_create': True,'no_open':True}"/>
                            <field name="template_id" required="1" widget="selection"
                                   domain="[('model','=','hr.employee.salary.letter')]"/>
                            <field name="destination_id" options="{'no_create': True,'no_open':True}"/>
                        </group>
                        <group>
                            <field name="date" invisible="1"/>
                            <field name="model_id" invisible="1"/>
                        </group>
                    </group>
                    <field name="body_html" widget="html" readonly="1" options='{"safe": True}'/>
                </sheet>
                <footer>
                    <button class="oe_highlight" name="action_print" type="object" string="Print"/>
                    <button string="Cancel" class="btn-default" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>


    <record id="hr_employee_salary_letter_action" model="ir.actions.act_window">
        <field name="name">Print Salary Letter</field>
        <field name="res_model">hr.employee.salary.letter</field>

        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="view_id" ref="hr_employee_salary_letter_view"/>
    </record>

    <report
            id="hr_employee_salary_letter_report2"
            string="Print"
            model="hr.employee.salary.letter"
            report_type="qweb-pdf"
            file="ejad_erp_hr.hr_salary_template_report_pdf"
            name="ejad_erp_hr.hr_salary_template_report_pdf"
    />

    <record id="hr_employee_salary_letter_destination_view" model="ir.ui.view">
        <field name="name">hr.employee.salary.letter.destination.view</field>
        <field name="model">hr.employee.salary.letter.destination</field>
        <field name="arch" type="xml">
            <tree string="Salary Letter Destination" editable="top">
                <field name="name"/>
                <field name="active"/>
            </tree>
        </field>
    </record>

    <record id="hr_employee_salary_letter_destination_action" model="ir.actions.act_window">
        <field name="name">اعداد جهات تعريف الراتب</field>
        <field name="res_model">hr.employee.salary.letter.destination</field>

        <field name="view_mode">tree</field>
        <field name="view_id" ref="hr_employee_salary_letter_destination_view"/>
    </record>

    <menuitem id="menu_salary_letter_destination" action="hr_employee_salary_letter_destination_action"
              parent="hr.menu_human_resources_configuration" groups="ejad_erp_hr.group_salary_letter_config"/>

    <report
            id="hr_attendance.hr_employee_print_badge"
            string="Print Badge"
            model="hr.employee"
            report_type="qweb-pdf"
            name="hr_attendance.print_employee_badge"
            file="hr_attendance.print_employee_badge"
            menu="False"
            print_report_name="'Print Badge - %s' % (object.name).replace('/', '')"
    />

    <record id="hr_contract_custom_form_inherit" model="ir.ui.view">
        <field name="name">hr.contract.view.form.inherit</field>
        <field name="model">hr.contract</field>
        <field name="inherit_id" ref="hr_contract.hr_contract_view_form"/>
        <field name="arch" type="xml">

            <field name="state" position="replace">

                <!--<button name="open_wizard" context="{'contract_name':name}" string="Salary Letter" type="object"-->
                <!--class="oe_highlight"/>-->

                <!--<button name="workflow_next" string="المرحلة التالية"-->
                <!--attrs="{'invisible':[('is_workflow_next_allowed', '=', False)]}"-->
                <!--type="object"-->
                <!--class="oe_highlight reload_page_js"/>-->

                <!--<button name="workflow_previous" string="الرجوع لمرحلة سابقة"-->
                <!--attrs="{'invisible':[('is_workflow_previous_allowed', '=', False)]}"-->
                <!--type="object"-->
                <!--class="oe_highlight reload_page_js"/>-->

                <!--                <button name="%(contract_refuse_wizard_action)d"-->
                <!--                            string="Cancel"-->
                <!--                            attrs="{'invisible':[('is_refuse_action_allowed', '=', False)]}"-->
                <!--                            type="action"/>-->

                <!--<field name="stage_id" widget="statusbar"  domain="[('id', 'in', related_stages)]"/>-->

                <!--                <div attrs="{'invisible':['|',('stage_id','=',False),('have_secondary_stage','=',False)]}">-->
                <!--                    <field name="current_second_stage" widget="statusbar" domain="[('id', 'in', related_secondary_stages)]"/>-->
                <!--                </div>-->


                <group invisible="1">
                    <field name="is_workflow_next_allowed" invisible="1"/>
                    <field name="related_stages" invisible="1"/>
                    <field name="have_secondary_stage" invisible="1"/>
                    <field name="related_secondary_stages" invisible="1"/>
                    <field name="is_workflow_previous_allowed" invisible="1"/>
                    <field name="is_refuse_action_allowed" invisible="1"/>
                    <field name="state" invisible="1"/>
                </group>
                 <button name="action_support_services_manager" type="object" string=" تأكيد أخصائي الموارد البشرية"
                            states="draft" class="oe_highlight" groups="ejad_erp_hr.contract_access_waiting_approval_1"/>
                    <button name="action_office_leader" class="oe_highlight" type="object"
                            string="موافقة مدير إدارة الخدمات المساندة"
                            states="support_services_manager" groups="ejad_erp_hr.contract_access_waiting_approval_2"/>
                    <button name="action_open" class="oe_highlight" type="object"
                            string="موافقة قائد المكتب"
                            states="office_leader" groups="ejad_erp_hr.contract_access_waiting_approval_3"/>

                <field name="state" widget="statusbar" statusbar_visible="draft,support_services_manager,office_leader,open"  />


            </field>

            <xpath expr="//field[@name='department_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>
            </xpath>

            <xpath expr="//field[@name='job_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>
            </xpath>

            <xpath expr="//field[@name='employee_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>
            </xpath>

            <xpath expr="//field[@name='resource_calendar_id']" position="attributes">
                <attribute name="options">{
                    "no_create": True,
                    "no_open": True,
                    }
                </attribute>
            </xpath>

            <field name="job_id" position="after">
                <field name="contract_type"/>
                <field name="grade_type_id" domain="[('contract_type', '=', contract_type)]"
                       attrs="{'invisible':[('is_exceptional','=',True)]}"
                       options="{'no_create': True,'no_open':True}"/>
                <!--                 <field name="grade_id" />
                 -->
                <field name="grade_level_id" domain="[('grade_type_id', '=', grade_type_id)]"
                       attrs="{'invisible':[('is_exceptional','=',True)]}"
                       options="{'no_create': True,'no_open':True}"/>
                <!--                 <field name="grade_id"/>
                -->
                <field name="is_exceptional"/>
                <field name="gross_salary"/>
            </field>
            <!--            <field name="type_id" position="attributes">-->
            <!--                <attribute name="invisible">0</attribute>-->
            <!--            </field>-->


            <!--<xpath expr="//field[@name='journal_id']" position="after">-->
            <!--<field name="has_housing_allow"/>-->
            <!--</xpath>-->
<!--todo migrqtion 15-->
<!--            <xpath expr="//group[@name='main_info']" position="after">-->
<!--                <group string="Allowances">-->
<!--                    <group>-->
<!--                        &lt;!&ndash;                     <label for="remaining_leaves"/>-->
<!--                                            <div>-->
<!--                                                <field name="remaining_leaves" class="oe_inline"/> days-->
<!--                                            </div> &ndash;&gt;-->
<!--                        <field name="has_housing_allow" attrs="{'invisible':[('is_exceptional','=',True)]}"/>-->
<!--                        <field name="transfer_allowance" invisible="1"/>-->
<!--                        <field name="assignment_allowance" invisible="1"/>-->
<!--                        <field name="annual_allowance" invisible="1"/>-->
<!--                        <field name="special_allowance" invisible="1"/>-->
<!--                        <field name="other_allowancme" attrs="{'invisible':[('is_exceptional','=',True)]}"/>-->
<!--                        <field name="hosing_allowancme" attrs="{'invisible':[('is_exceptional','=',True)]}"/>-->

<!--                        <field name="excp_wage" attrs="{'invisible':[('is_exceptional','!=',True)]}"/>-->
<!--                        <field name="excp_housing" attrs="{'invisible':[('is_exceptional','!=',True)]}"/>-->
<!--                        <field name="excp_transportation" attrs="{'invisible':[('is_exceptional','!=',True)]}"/>-->
<!--                        <field name="excp_others" attrs="{'invisible':[('is_exceptional','!=',True)]}"/>-->
<!--                        <field name="is_exceptional_insurance"/>-->
<!--                        <field name="insurance_amount" attrs="{'invisible':[('is_exceptional_insurance','!=',True)]}"/>-->
<!--                    </group>-->
<!--                    &lt;!&ndash;                 <group>-->
<!--                                        <field name="other_allowance"/>-->

<!--                                    </group> &ndash;&gt;-->
<!--                </group>-->
<!--            </xpath>-->
            <field name="wage" position="attributes">
                <attribute name="attrs">{'invisible':[('is_exceptional','=',True)]}</attribute>
            </field>
            <xpath expr="//div[@name='wage']" position="attributes">
                <attribute name="attrs">{'invisible':[('is_exceptional','=',True)]}</attribute>
            </xpath>
            <xpath expr="//label[@for='wage']" position="attributes">
                <attribute name="attrs">{'invisible':[('is_exceptional','=',True)]}</attribute>
            </xpath>
<!-- todo migrqtion 15-->
<!--            <xpath expr="//group[@name='salary_and_advantages']" position="attributes">-->
<!--                <attribute name="attrs">{'invisible':[('is_exceptional','=',True)]}</attribute>-->
<!--            </xpath>-->

            <!--  <field name="wage" position="after">




             </field> -->
        </field>
    </record>
<!--    <record id="hr_contract.hr_menu_contract" model="ir.ui.menu">-->
<!--        <field name="groups_id"-->
<!--               eval="[(3, ref('hr.group_hr_manager')), (4, ref('ejad_erp_hr.group_contract_edit_create'))]"/>-->
<!--    </record>-->

    <record model="ir.ui.menu" id="hr.menu_hr_department_tree">
        <field name="groups_id" eval="[(6,0,[ref('ejad_erp_hr.hr_departments_sub_menu')])]"/>
    </record>

    <record model="ir.ui.menu" id="hr.menu_human_resources_configuration">
        <field name="groups_id" eval="[(6,0,[ref('ejad_erp_hr.hr_employee_configuration_sub_menu')])]"/>
    </record>

    <record id="action_employee_mandate_request" model="ir.actions.act_window">
        <field name="name">طلبات الانتداب</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">hr.mandate.request</field>

        <field name="view_mode">tree,form</field>
        <field name="help">Employee Mandate Request</field>
        <field name="context">
            {
            'search_default_employee_id': [active_id],
            'default_employee_id': active_id,
            'search_default_group_by_state': 1
            }
        </field>
        <field name="domain">[('employee_id','=',active_id)]</field>
    </record>

    <record id="view_hr_empployee_inherit1" model="ir.ui.view">
        <field name="name">hr.employee.inherit.form</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.view_employee_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[1]" position="inside">
                <button class="oe_stat_button" name="%(action_employee_mandate_request)d"
                        type="action"
                        icon="fa-info">
                    <field string="طلبات الانتداب" name="employee_mandate_count" widget="statinfo"/>
                </button>
            </xpath>
        </field>
    </record>

    <record id="view_hr_payslip_by_employees" model="ir.ui.view">
        <field name="name">hr_payroll_payslip_employees</field>
        <field name="model">hr.payslip.employees</field>
        <field name="inherit_id" ref="hr_payroll.view_hr_payslip_by_employees"/>
        <field name="arch" type="xml">
            <field name="employee_ids" position="replace">
                <field name="employee_ids" nolabel="1" domain="[('id','not in',p_employee_ids)]">
                    <tree>
                        <field name="name"/>
                        <field name="emp_attendance_no" string="رقم الموظف"/>
                    </tree>
                </field>

                <field name="p_employee_ids" invisible="1"/>
            </field>
        </field>
    </record>

    <record id="hr.open_view_employee_list_my" model="ir.actions.act_window">
        <field name="context">{'employee_action':True}</field>
    </record>

</odoo>
