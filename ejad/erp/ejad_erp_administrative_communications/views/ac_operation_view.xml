<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="ac_operation_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags"/>
                <field name="incoming_no"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
            </tree>
        </field>
    </record>
    <!-- ############################# الوارد العام ############################# -->

    <record id="ac_operation_view_pivot" model="ir.ui.view">
        <field name="name">ac.operation.pivot</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <pivot string="المعاملات">
                <field name="state" type="row"/>
                <field name="security" type="row"/>
                <field name="priority" type="row"/>
                <field name="date" type="col"/>
                <field name="attachments_no" type="measure"/>
            </pivot>
        </field>
    </record>

    <record id="ac_operation_view_graph" model="ir.ui.view">
        <field name="name">ac.operation.graph</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <graph string="المعاملات">
                <field name="state"/>
                <field name="security"/>
                <field name="priority"/>
                <field name="date"/>
                <field name="attachments_no" type="measure"/>
            </graph>
        </field>
    </record>

    <record id="ac_global_inbox_form" model="ir.ui.view">
        <field name="name">ac.operation.form</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_save_action)d" string="حفظ المعاملة" type="action"
                            attrs="{'invisible': ['|',('state_detailed', 'not in', ['global_inbox']),('state', '!=', 'open')]}" class="oe_highlight save-treatment"/>
                    <button name="action_reopen" string="إعادة فتح المعاملة" type="object"
                            attrs="{'invisible': [('state', 'not in', ['done','canceled'])]}"
                            groups="ejad_erp_administrative_communications.access_reopen_operations" class="oe_highlight reopen-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_transfer_action)d" string="إحالة المعاملة" type="action"
                            attrs="{'invisible':['|',('state_detailed', 'not in', ['global_inbox']),('state', '=', 'done')]}" context="{'default_department_id':department_ids}" class="oe_highlight redirect-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_comment_action)d" string="إضافة تعليق"
                            attrs="{'invisible':[('id', '=', False)]}" type="action" class="add-comment"/>

                    <button name="apply_marking" string="التأشير على المعاملة" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_marking" class="sign-treatment"/>

                    <button name="apply_dismarking" string="الغاء التأشير" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','!=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_dis_marking" class="cancel-sign"/>

                    <button name="action_cancel" string="إلغاء المعاملة" type="object"
                            attrs="{'invisible':[('state', '!=', 'draft')]}" class="oe_link cancel-treatment"/>

                    <button name="%(ejad_erp_administrative_communications.ac_operation_report)d" string="طباعة المعاملة" type="action"
                            class="oe_highlight print-treatment"/>

                    <button name="follow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="متابعة" type="object" attrs="{'invisible':[('is_follow', '!=', 1)]}" class="follow-treatment"/>
                    <button name="unfollow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="إلغاء المتابعة" type="object" attrs="{'invisible':[('is_follow', '!=', 2)]}" class="unfollow-treatment"/>
                    <button name="sign_operation" groups="ejad_erp_administrative_communications.access_sign_operations"
                            string="التوقيع على المعاملة" type="object"  attrs="{'invisible': ['|',
                                ('sign_data', '!=', False),
                                ('state', '!=', 'open')]}"  class="oe_highlight" />

                    <field name="message" style="color:red;" attrs="{'invisible':[('state_detailed', 'in', ['global_inbox'])]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,open,done"/>
                    <field name="state_detailed" invisible="1"/>
                    <field name="id" invisible="1"/>
                    <field name="type" invisible="1"/>
                    <field name="department_ids" invisible="1" options="{'no_create': True, 'no_open': True}"/>
                    <field name="is_editing_benefit_note" invisible="1"/>
                    <field name="is_follow" invisible="1"/>
                    <field name="user_ids" widget="many2many_tags" invisible="1"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_operation_history" string="سجل الحركات" icon="fa-bar-chart-o">
                        </button>
                        <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="ejad_erp_administrative_communications.group_operation_archive">
                            <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                        </button>
                    </div>
                    <h1 class="mt0">
                        <spam string="معاملة مسودة" attrs="{'invisible': [('name', '!=', False)]}"/>
                        <div  attrs="{'invisible': [('name', '=', False)]}">
                            <field name="name" class="oe_inline" readonly="1"/>
                        </div>
                    </h1>
                    <group>
                        <group>
                            <field name="marking" readonly="1"/>
                            <field name="external_partner_ids" widget="many2many_tags" domain="[('is_ac_eligible','=',True)]" context="{'default_is_ac_eligible':True}" string="جهة الوارد"/>
                            <field name="date"/>
                            <field name="subject"/>
                            <field name="nature" widget="selection" domain="[('code','not in',['ac_nature_or','ac_nature_gn'])]"/>
                            <field name="receive_method" widget="selection"/>

                            <field name="linked_id" domain="[('id', '!=', id)]" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}"/>
                            <field name="deadline_date"/>
                            <!--<field name="country_id" options="{'no_create': True, 'no_open': True}"/>-->
                            <field name="department_sequence"/>
                            <field name="incoming_date"/>
                            <field name="incoming_no"/>
                            <field name="dest" string="جهة الإحالة"/>

                            <field name="priority" widget="priority"/>
                            <field name="security" widget="priority"/>
                            <field name="sign_data"/>
                            <field name="is_sign_completed"/>
                            <field name="sign_user_id" invisible="1"/>
                            <field name="auditor" attrs="{'invisible':[('dest','!=','auditor')]}"/>
                            <field name="partner_id" attrs="{'invisible':[('dest','!=','beneficiary')]}"/>
                            <field name="employee_id" attrs="{'invisible':[('dest','!=','emp')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="ident_no" attrs="{'invisible':[('dest','not in',['auditor','emp','beneficiary'])]}"/>
                            <field name="show_attachment" invisible="1"/>
                        </group>
                        <group>
                            <field name="operation_attachment" widget="pdf_viewer" nolabel="1" attrs="{'invisible':[('show_attachment','!=',True),('id','!=',False)]}"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="المعاملات ذات العلاقة" groups="ejad_erp_administrative_communications.access_related_operations">
                            <field nolabel="1" name="linked_operation_ids" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}" groups="ejad_erp_administrative_communications.access_related_operations"/>
                        </page>
                        <page string="نص الموضوع">
                            <field name="details" widget="html"/>
                        </page>

                        <page string="الإدارات/ الأقسام" attrs="{'invisible':[('dest','!=','dept')]}">
                            <field name="department_ids"
                                   domain="[('is_ac_eligible','=',True)]" attrs="{'invisible':[('dest','!=','dept')]}">
                                <tree create="true" edit="true" delete="true">
                                    <field name="code"/>
                                    <field name="display_name"/>
                                    <field name="parent_id"/>
                                    <field name="manager_id"/>
                                </tree>
                            </field>
                        </page>
                        <page string="الإفادة">

                            <field name="benefit_note" widget="html" attrs="{'readonly':[('is_editing_benefit_note', '!=', True)]}"/>
                        </page>
                        <page string="معلومات أخرى">
                            <group>
                                <group>
                                    <field name="directing" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_no" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="subject_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="is_editing_other_info" invisible="1"/>
                                </group>
                                <group>
                                    <field name="directing_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="deadline_state"/>
                                </group>
                            </group>
                        </page>

                        <page string="المرفقات" attrs="{'invisible':[('type', '=', 'generalization')]}">
                            <group>
                                <field name="attachments_no"/>
                            </group>
                            <field name="attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="المرفقات" attrs="{'invisible':[('type', '!=', 'generalization')]}">
                            <field name="generalization_attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="التعليقات">
                            <field name="comment_ids">
                                <tree create="false">
                                    <field name="date"/>
                                    <field name="user_id"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="date"/>
                                        <field name="user_id"/>
                                        <field name="comment" widget="html"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="الملاحظات">
                            <field name="notes"/>
                        </page>
                        <page string="مدخل البيانات" groups="ejad_erp_administrative_communications.group_operation_settings">
                            <br/>
                            <group attrs="{'invisible':[('id','!=',False)]}">
                                <field name="create_employee_id" string="الموظف" options="{'no_create': True, 'no_open': True}"/>
                            </group>
                            <field name="emp_image" widget="image" class="oe_avatar"/>
                            <div class="oe_title">
                                <h1>
                                    <field name="emp_name"/>
                                </h1>
                                <div class="o_row">
                                    <field name="emp_department"/>
                                </div>
                            </div>
                            <group>
                                <group>
                                    <field name="emp_email" widget="email"/>
                                </group>
                                <group>
                                    <field name="date_create"/>
                                </group>
                            </group>
                        </page>
                        <page string="المُطّلعين على المعاملة" groups="ejad_erp_administrative_communications.access_users_viewer">
                            <field name="seen_users_ids">
                                <tree>
                                    <field name="user"/>
                                    <field name="seen_date_time"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" domain="[('message_type','=','mail')]" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="ac_global_inbox_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree decoration-info="priority=='1'" decoration-warning="priority=='2'"
                  decoration-danger="priority=='3'" class="tree_no_open">
                <field name="name"/>
                <!--<field name="department_sequence"/>-->
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags" string="جهة الوارد"/>
                <!--<field name="incoming_date"/>-->
                <field name="incoming_no"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="marking" readonly="1"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
                <button name="show_operation" type="object" icon="fa-external-link" string="عرض المعاملة"/>
            </tree>
        </field>
    </record>

    <record id="action_ac_operation_in_general" model="ir.actions.act_window">
        <field name="name">الوارد العام</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="view_mode">tree,form,kanban,graph,pivot</field>
        <field name="domain">[('type','=','in'),('is_global_inbox','=',True)]</field>
        <field name="limit">80</field>
        <field name="context">{'default_type' : 'in','default_is_global_inbox' : True,'default_state_detailed' : 'global_inbox'}</field>
    </record>

    <record id="child_global_inbox_action_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="view_id" ref="ac_global_inbox_tree"/>
        <field name="act_window_id" ref="action_ac_operation_in_general"/>
    </record>
    <record id="child_global_inbox_action_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="view_id" ref="ac_global_inbox_form"/>
        <field name="act_window_id" ref="action_ac_operation_in_general"/>
    </record>


    <!-- ############################# الصادر العام ############################# -->

    <record id="ac_global_outbox_form" model="ir.ui.view">
        <field name="name">ac.operation.form</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <form create="true">
                <header>
                    <button name="action_export" string="تصدير المعاملة" type="object"
                            attrs="{'invisible':[('is_exported', '=', True)]}" class="oe_highlight export-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_save_action)d" string="حفظ المعاملة" type="action"
                            attrs="{'invisible': [('state', '!=', 'open')]}" class="oe_highlight save-treatment"/>
                    <button name="action_reopen" string="إعادة فتح المعاملة" type="object"
                            attrs="{'invisible': [('state', 'not in', ['done','canceled'])]}"
                            groups="ejad_erp_administrative_communications.access_reopen_operations" class="oe_highlight reopen-treatment"/>
                    <!--<button name="%(ejad_erp_administrative_communications.ac_operation_transfer_action)d"
                            string="إحالة المعاملة" type="action" class="oe_highlight"
                            attrs="{'invisible':['|',('state', '=', 'done'),('is_global_outbox', '=', True)]}"/>-->
                    <button name="%(ejad_erp_administrative_communications.ac_operation_comment_action)d" string="إضافة تعليق"
                            type="action" attrs="{'invisible':[('state', '!=', 'open')]}" class="add-comment"/>
                    <button name="apply_marking" string="التأشير على المعاملة" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_marking" class="sign-treatment"/>

                    <button name="apply_dismarking" string="الغاء التأشير" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','!=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_dis_marking" class="cancel-sign"/>
                    <button name="action_cancel" string="إلغاء المعاملة" type="object"
                            attrs="{'invisible':[('state', '!=', 'draft')]}" class="oe_link cancel-treatment"/>

                    <button name="%(ejad_erp_administrative_communications.ac_operation_report)d" string="طباعة المعاملة" type="action"
                            class="oe_highlight print-treatment"/>
                    <button name="follow_operation" class="follow-treatment" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="متابعة" type="object" attrs="{'invisible':[('is_follow', '!=', 1)]}"/>
                    <button name="unfollow_operation" class="unfollow-treatment" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="إلغاء المتابعة" type="object" attrs="{'invisible':[('is_follow', '!=', 2)]}"/>
                    <field name="message" style="color:red;" attrs="{'invisible':[('state_detailed', 'in', ['global_outbox'])]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,open,done"/>
                    <field name="state_detailed" invisible="1"/>
                    <field name="is_exported" invisible="1"/>
                    <field name="is_global_outbox" invisible="1"/>
                    <field name="type" invisible="1"/>
                    <field name="user_ids" widget="many2many_tags" invisible="1"/>
                    <field name="is_follow" invisible="1"/>
                    <field name="id" invisible="1"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_operation_history" string="سجل الحركات" icon="fa-bar-chart-o">
                        </button>
                        <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="ejad_erp_administrative_communications.group_operation_archive">
                            <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                        </button>
                    </div>
                    <h1 class="mt0">
                        <spam string="معاملة مسودة" attrs="{'invisible': [('name', '!=', False)]}"/>
                        <div  attrs="{'invisible': [('name', '=', False)]}">
                            <field name="name" class="oe_inline" readonly="1"/>
                        </div>
                    </h1>
                    <group>
                        <group>
                            <field name="marking" readonly="1"/>
                            <field name="external_partner_ids" widget="many2many_tags" string="جهة الصادر"/>
                            <!--<field name="specific_dept"/>-->
                            <!--<field name="specific_person"/>-->
                            <field name="date"/>
                            <field name="subject"/>
                            <field name="nature" widget="selection" domain="[('code','!=','ac_nature_or')]"/>


                            <field name="linked_id" domain="[('id', '!=', id)]" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}"/>
                            <field name="deadline_date"/>
                            <!--<field name="country_id" options="{'no_create': True, 'no_open': True}"/>-->
                            <field name="department_sequence"/>
                            <field name="dest"/>

                            <field name="priority" widget="priority"/>
                            <field name="security" widget="priority"/>
                            <field name="auditor" attrs="{'invisible':[('dest','!=','auditor')]}"/>
                            <field name="partner_id" attrs="{'invisible':[('dest','!=','beneficiary')]}"/>
                            <field name="employee_id" attrs="{'invisible':[('dest','!=','emp')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="department_ids" attrs="{'invisible':[('dest','!=','dept')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="ident_no" attrs="{'invisible':[('dest','not in',['auditor','emp','beneficiary'])]}"/>
                            <field name="receive_method" widget="selection" attrs="{'invisible': [('receive_method', '=', False)]}"/>
                            <field name="show_attachment" invisible="1"/>
                        </group>
                        <group>
                            <field name="operation_attachment" widget="pdf_viewer" nolabel="1" attrs="{'invisible':[('show_attachment','!=',True),('id','!=',False)]}"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="المعاملات ذات العلاقة" groups="ejad_erp_administrative_communications.access_related_operations">
                            <field nolabel="1" name="linked_operation_ids" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}" groups="ejad_erp_administrative_communications.access_related_operations"/>
                        </page>
                        <page string="نص الموضوع">
                            <field name="details" widget="html"/>
                        </page>

                        <page string="الإفادة">
                            <field name="is_editing_benefit_note" invisible="1"/>
                            <field name="benefit_note" widget="html" attrs="{'readonly':[('is_editing_benefit_note', '!=', True)]}"/>
                        </page>

                        <page string="معلومات أخرى">
                            <group>
                                <group>
                                    <field name="directing" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_no" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="subject_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="is_editing_other_info" invisible="1"/>
                                </group>
                                <group>
                                    <field name="directing_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="deadline_state"/>
                                </group>
                            </group>
                        </page>

                        <page string="المرفقات" attrs="{'invisible':[('type', '=', 'generalization')]}">
                            <group>
                                <field name="attachments_no"/>
                            </group>
                            <field name="attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="المرفقات" attrs="{'invisible':[('type', '!=', 'generalization')]}">
                            <field name="generalization_attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="التعليقات">
                            <field name="comment_ids">
                                <tree create="false">
                                    <field name="date"/>
                                    <field name="user_id"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="date"/>
                                        <field name="user_id"/>
                                        <field name="comment" widget="html"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="الملاحظات">
                            <field name="notes"/>
                        </page>
                        <page string="المُطّلعين على المعاملة" groups="ejad_erp_administrative_communications.access_users_viewer">
                            <field name="seen_users_ids">
                                <tree>
                                    <field name="user"/>
                                    <field name="seen_date_time"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="ac_global_outbox_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree decoration-info="priority=='1'" decoration-warning="priority=='2'"
                  decoration-danger="priority=='3'" create="true" class="tree_no_open">
                <field name="name"/>
                <!--<field name="department_sequence"/>-->
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags" string="جهة الصادر"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="marking" readonly="1"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
                <button name="show_operation" type="object" icon="fa-external-link" string="عرض المعاملة"/>
            </tree>
        </field>
    </record>

    <record id="action_ac_operation_out_general" model="ir.actions.act_window">
        <field name="name">الصادر العام</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="view_mode">tree,form,kanban,graph,pivot</field>
        <field name="limit">80</field>
        <field name="context">{'default_is_global_outbox':True}</field>
        <field name="domain">[('is_global_outbox', '=', True)]</field>
    </record>

    <record id="child_global_outbox_action_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="view_id" ref="ac_global_outbox_tree"/>
        <field name="act_window_id" ref="action_ac_operation_out_general"/>
    </record>
    <record id="child_global_outbox_action_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="view_id" ref="ac_global_outbox_form"/>
        <field name="act_window_id" ref="action_ac_operation_out_general"/>
    </record>

    <!-- ############################# وارد الإدارة ############################# -->

    <record id="department_inbox_form" model="ir.ui.view">
        <field name="name">ac.operation.form</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <form create="false">
                <header>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_save_action)d" string="حفظ المعاملة" type="action"
                            attrs="{'invisible': ['|',('state_detailed', 'not in', ['department_inbox']),('state', '!=', 'open')]}" class="oe_highlight save-treatment"/>
                    <button name="action_reopen" string="إعادة فتح المعاملة" type="object"
                            attrs="{'invisible': [('state', 'not in', ['done','canceled'])]}"
                            groups="ejad_erp_administrative_communications.access_reopen_operations" class="oe_highlight reopen-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_transfer_action)d" string="إحالة المعاملة" type="action"
                            attrs="{'invisible':['|',('state_detailed', 'not in', ['department_inbox']),('state', '=', 'done')]}" class="oe_highlight redirect-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_comment_action)d" string="إضافة تعليق"
                            type="action" attrs="{'invisible':[('state', '!=', 'open')]}" class="add-comment"/>
                    <button name="apply_marking" string="التأشير على المعاملة" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_marking" class="sign-treatment"/>

                    <button name="apply_dismarking" string="الغاء التأشير" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','!=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_dis_marking" class="cancel-sign"/>
                    <button name="action_cancel" string="إلغاء المعاملة" type="object"
                            attrs="{'invisible':[('state', '!=', 'draft')]}" class="oe_link cancel-treatment"/>

                    <button name="%(ejad_erp_administrative_communications.ac_operation_report)d" string="طباعة المعاملة" type="action"
                            class="oe_highlight print-treatment"/>
                    <button name="follow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="متابعة" type="object" class="follow-treatment" attrs="{'invisible':[('is_follow', '!=', 1)]}"/>
                    <button name="unfollow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="إلغاء المتابعة" class="unfollow-treatment" type="object" attrs="{'invisible':[('is_follow', '!=', 2)]}"/>
                   <field name="message" style="color:red;" attrs="{'invisible':[('state_detailed', 'in', ['global_inbox'])]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,open,done"/>
                    <field name="state_detailed" invisible="1"/>
                    <field name="type" invisible="1"/>
                    <field name="user_ids" widget="many2many_tags" invisible="1"/>
                    <field name="is_follow" invisible="1"/>
                    <field name="id" invisible="1"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <field name="be_shown" invisible="1"/>
                        <button name="toggle_done_department" type="object" class="oe_stat_button"
                                icon="fa-check" attrs="{'invisible': [('be_shown', '=', False)]}">
                            <field name="is_done" widget="boolean_button"
                                   options='{"terminology": {
                                                "string_true": "منتهية",
                                                "hover_true": "فتح المعاملة",
                                                "string_false": "غير منتهية",
                                                "hover_false": "انهاء المعاملة"
                                            }}'
                            />
                        </button>
                        <button class="oe_stat_button" type="object" name="action_operation_history" string="سجل الحركات" icon="fa-bar-chart-o">
                        </button>
                        <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="ejad_erp_administrative_communications.group_operation_archive">
                            <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                        </button>
                    </div>
                    <h1 class="mt0">
                        <spam string="معاملة مسودة" attrs="{'invisible': [('name', '!=', False)]}"/>
                        <div  attrs="{'invisible': [('name', '=', False)]}">
                            <field name="name" class="oe_inline" readonly="1"/>
                        </div>
                    </h1>
                    <group>
                        <group>
                            <field name="marking" readonly="1"/>
                            <field name="external_partner_ids" string="جهة الوارد" widget="many2many_tags" attrs="{'invisible': [('external_partner_ids', '=', False)]}"/>
                            <field name="date"/>
                            <field name="subject"/>
                            <field name="nature" widget="selection"/>


                            <field name="linked_id" domain="[('id', '!=', id)]" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}"/>
                            <field name="department_deadline_date" string="تاريخ الانجاز الخاص بالادارة"
                                   attrs="{'invisible': [('department_deadline_date', '=', False)]}"/>
                            <field name="deadline_date"/>
                            <!--<field name="country_id" options="{'no_create': True, 'no_open': True}"/>-->
                            <field name="department_sequence"/>
                            <field name="incoming_date"/>
                            <field name="incoming_no"/>
                            <field name="dest" string="جهة الإحالة"/>
                             <field name="priority" widget="priority"/>
                            <field name="security" widget="priority"/>
                            <field name="auditor" attrs="{'invisible':[('dest','!=','auditor')]}"/>
                            <field name="partner_id" attrs="{'invisible':[('dest','!=','beneficiary')]}"/>
                            <field name="employee_id" attrs="{'invisible':[('dest','!=','emp')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="department_ids" attrs="{'invisible':[('dest','!=','dept')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="ident_no" attrs="{'invisible':[('dest','not in',['auditor','emp','beneficiary'])]}"/>
                            <field name="receive_method" widget="selection" attrs="{'invisible': [('receive_method', '=', False)]}" />
                            <field name="show_attachment" invisible="1"/>
                        </group>
                        <group>
                            <field name="operation_attachment" widget="pdf_viewer" nolabel="1" attrs="{'invisible':[('show_attachment','!=',True),('id','!=',False)]}"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="المعاملات ذات العلاقة" groups="ejad_erp_administrative_communications.access_related_operations">
                            <field nolabel="1" name="linked_operation_ids" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}" groups="ejad_erp_administrative_communications.access_related_operations"/>
                        </page>
                        <page string="نص الموضوع">
                            <field name="details" widget="html"/>
                        </page>

                        <page string="الإفادة">
                            <field name="is_editing_benefit_note" invisible="1"/>
                            <field name="benefit_note" widget="html" attrs="{'readonly':[('is_editing_benefit_note', '!=', True)]}"/>
                        </page>

                        <page string="معلومات أخرى">
                            <group>
                                <group>
                                    <field name="directing" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_no" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="subject_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="is_editing_other_info" invisible="1"/>
                                </group>
                                <group>
                                    <field name="directing_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="deadline_state"/>
                                </group>
                            </group>
                        </page>

                        <page string="المرفقات" attrs="{'invisible':[('type', '=', 'generalization')]}">
                            <group>
                                <field name="attachments_no"/>
                            </group>
                            <field name="attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="المرفقات" attrs="{'invisible':[('type', '!=', 'generalization')]}">
                            <field name="generalization_attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="التعليقات">
                            <field name="comment_ids">
                                <tree create="false">
                                    <field name="date"/>
                                    <field name="user_id"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="date"/>
                                        <field name="user_id"/>
                                        <field name="comment" widget="html"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="الملاحظات">
                            <field name="notes"/>
                        </page>
                        <page string="المُطّلعين على المعاملة" groups="ejad_erp_administrative_communications.access_users_viewer">
                            <field name="seen_users_ids">
                                <tree>
                                    <field name="user"/>
                                    <field name="seen_date_time"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="department_inbox_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree decoration-info="priority=='1'" decoration-warning="priority=='2'"
                  decoration-danger="priority=='3'" create="false" class="tree_no_open">
                <field name="name"/>
                <!--<field name="department_sequence"/>-->
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags" string="جهة الوارد"/>
                <!--<field name="incoming_date"/>-->
                <field name="incoming_no"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="marking" readonly="1"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
                <button name="show_operation" type="object" icon="fa-external-link" string="عرض المعاملة"/>
            </tree>
        </field>
    </record>

    <record id="action_ac_operation_department_in" model="ir.actions.act_window">
        <field name="name">وارد الادارة</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="limit">80</field>
        <field name="view_mode">tree,form,kanban,graph,pivot</field>
        <field name="context">{'incoming_operation_check':True}</field>
        <field name="domain">[('is_department_inbox','=',True)]</field>
    </record>
    <record id="child_department_inbox_action_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="view_id" ref="department_inbox_tree"/>
        <field name="act_window_id" ref="action_ac_operation_department_in"/>
    </record>
    <record id="child_department_inbox_action_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="view_id" ref="department_inbox_form"/>
        <field name="act_window_id" ref="action_ac_operation_department_in"/>
    </record>


    <!-- ############################# صادر الإدارة ############################# -->

    <record id="department_outbox_form" model="ir.ui.view">
        <field name="name">ac.operation.form</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_save_action)d" string="حفظ المعاملة" type="action"
                            attrs="{'invisible': [('state', '!=', 'open')]}" class="oe_highlight save-treatment"/>
                    <button name="action_reopen" string="إعادة فتح المعاملة" type="object"
                            attrs="{'invisible': [('state', 'not in', ['done','canceled'])]}"
                            groups="ejad_erp_administrative_communications.access_reopen_operations" class="oe_highlight reopen-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_transfer_action)d"
                            string="إحالة المعاملة" type="action" class="oe_highlight redirect-treatment" attrs="{'invisible':[('state', '=', 'done')]}"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_comment_action)d" string="إضافة تعليق"
                            type="action" attrs="{'invisible':[('state', '!=', 'open')]}" class="add-comment"/>
                    <button name="apply_marking" string="التأشير على المعاملة" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_marking" class="sign-treatment"/>

                    <button name="apply_dismarking" string="الغاء التأشير" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','!=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_dis_marking" class="cancel-sign"/>
                    <button name="action_cancel" string="إلغاء المعاملة" type="object"
                            attrs="{'invisible':[('state', '!=', 'draft')]}" class="oe_link cancel-treatment"/>

                    <button name="%(ejad_erp_administrative_communications.ac_operation_report)d" string="طباعة المعاملة" type="action"
                            class="oe_highlight print-treatment"/>
                    <button name="follow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="متابعة" type="object" class="follow-treatment" attrs="{'invisible':[('is_follow', '!=', 1)]}"/>
                    <button name="unfollow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="إلغاء المتابعة" class="unfollow-treatment" type="object" attrs="{'invisible':[('is_follow', '!=', 2)]}"/>

                    <field name="state" widget="statusbar" statusbar_visible="draft,open,done"/>
                    <field name="type" invisible="1"/>
                    <field name="is_department_outbox" invisible="1"/>
                    <field name="user_ids" widget="many2many_tags" invisible="1"/>
                    <field name="is_follow" invisible="1"/>
                    <field name="id" invisible="1"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_operation_history" string="سجل الحركات" icon="fa-bar-chart-o">
                        </button>
                        <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="ejad_erp_administrative_communications.group_operation_archive">
                            <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                        </button>
                    </div>
                    <h1 class="mt0">
                        <spam string="معاملة مسودة" attrs="{'invisible': [('name', '!=', False)]}"/>
                        <div  attrs="{'invisible': [('name', '=', False)]}">
                            <field name="name" class="oe_inline" readonly="1"/>
                        </div>
                    </h1>
                    <group>
                        <group>
                            <field name="marking" readonly="1"/>
                            <field name="external_partner_ids" string="جهة الصادر" widget="many2many_tags" attrs="{'invisible': [('external_partner_ids', '=', False)]}"/>
                            <field name="date"/>
                            <field name="subject"/>
                            <field name="nature" widget="selection"/>


                            <field name="linked_id" domain="[('id', '!=', id)]" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}"/>
                            <field name="deadline_date"/>
                            <!--<field name="country_id" options="{'no_create': True, 'no_open': True}"/>-->
                            <field name="department_sequence"/>
                            <field name="dest"/>

                            <field name="priority" widget="priority"/>
                            <field name="security" widget="priority"/>
                            <field name="auditor" attrs="{'invisible':[('dest','!=','auditor')]}"/>
                            <field name="partner_id" attrs="{'invisible':[('dest','!=','beneficiary')]}"/>
                            <field name="employee_id" attrs="{'invisible':[('dest','!=','emp')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="department_ids" attrs="{'invisible':[('dest','!=','dept')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="ident_no" attrs="{'invisible':[('dest','not in',['auditor','emp','beneficiary'])]}"/>
                            <field name="receive_method" widget="selection" attrs="{'invisible': [('receive_method', '=', False)]}"/>
                            <field name="show_attachment" invisible="1"/>
                        </group>
                        <group>
                            <field name="operation_attachment" widget="pdf_viewer" nolabel="1" attrs="{'invisible':[('show_attachment','!=',True),('id','!=',False)]}"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="المعاملات ذات العلاقة" groups="ejad_erp_administrative_communications.access_related_operations">
                            <field nolabel="1" name="linked_operation_ids" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}" groups="ejad_erp_administrative_communications.access_related_operations"/>
                        </page>
                        <page string="نص الموضوع">
                            <field name="details" widget="html"/>
                        </page>

                        <page string="الإفادة">
                            <field name="is_editing_benefit_note" invisible="1"/>
                            <field name="benefit_note" widget="html" attrs="{'readonly':[('is_editing_benefit_note', '!=', True)]}"/>
                        </page>

                        <page string="معلومات أخرى">
                            <group>
                                <group>
                                    <field name="directing" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_no" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="subject_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="is_editing_other_info" invisible="1"/>
                                </group>
                                <group>
                                    <field name="directing_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="deadline_state"/>
                                </group>
                            </group>
                        </page>

                        <page string="المرفقات" attrs="{'invisible':[('type', '=', 'generalization')]}">
                            <group>
                                <field name="attachments_no"/>
                            </group>
                            <field name="attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="المرفقات" attrs="{'invisible':[('type', '!=', 'generalization')]}">
                            <field name="generalization_attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="التعليقات">
                            <field name="comment_ids">
                                <tree create="false">
                                    <field name="date"/>
                                    <field name="user_id"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="date"/>
                                        <field name="user_id"/>
                                        <field name="comment" widget="html"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="الملاحظات">
                            <field name="notes"/>
                        </page>
                        <page string="المُطّلعين على المعاملة" groups="ejad_erp_administrative_communications.access_users_viewer">
                            <field name="seen_users_ids">
                                <tree>
                                    <field name="user"/>
                                    <field name="seen_date_time"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="department_outbox_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree decoration-info="priority=='1'" decoration-warning="priority=='2'"
                  decoration-danger="priority=='3'" class="tree_no_open">
                <field name="name"/>
                <!--<field name="department_sequence"/>-->
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags" string="جهة الصادر"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="marking" readonly="1"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
                <button name="show_operation" type="object" icon="fa-external-link" string="عرض المعاملة"/>
            </tree>
        </field>
    </record>

    <record id="action_ac_operation_department_out" model="ir.actions.act_window">
        <field name="name">صادر الادارة</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="limit">80</field>
        <field name="view_mode">tree,form,kanban,graph,pivot</field>
        <field name="domain">[('is_department_outbox', '=', True)]</field>
        <field name="context">{'outgoing_operation_check':True,'default_is_department_outbox':True}</field>
    </record>
    <record id="child_department_outbox_action_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="view_id" ref="department_outbox_tree"/>
        <field name="act_window_id" ref="action_ac_operation_department_out"/>
    </record>
    <record id="child_department_outbox_action_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="view_id" ref="department_outbox_form"/>
        <field name="act_window_id" ref="action_ac_operation_department_out"/>
    </record>


    <!-- ############################# الوارد ############################# -->

    <record id="employee_inbox_form" model="ir.ui.view">
        <field name="name">ac.operation.form</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <form create="false">
                <header>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_save_action)d" string="حفظ المعاملة" type="action"
                            attrs="{'invisible': ['|','|',('is_ok', '!=', True),('state_detailed', 'not in', ['employee_inbox']),('state', '!=', 'open')]}" class="oe_highlight save-treatment"/>
                    <button name="action_reopen" string="إعادة فتح المعاملة" type="object"
                            attrs="{'invisible': [('state', 'not in', ['done','canceled'])]}"
                            groups="ejad_erp_administrative_communications.access_reopen_operations" class="oe_highlight reopen-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_transfer_action)d" string="إحالة المعاملة" type="action"
                            attrs="{'invisible':['|','|',('is_ok', '!=', True),('state_detailed', 'not in', ['employee_inbox']),('state', '=', 'done')]}" class="oe_highlight redirect-treatment" />
                    <button name="%(ejad_erp_administrative_communications.ac_operation_comment_action)d" string="إضافة تعليق"
                            attrs="{'invisible':[('state', '!=', 'open')]}" type="action" class="add-comment"/>
                    <button name="apply_marking" string="التأشير على المعاملة" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_marking" class="sign-treatment"/>

                    <button name="apply_dismarking" string="الغاء التأشير" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','!=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_dis_marking" class="cancel-sign"/>
                    <button name="action_cancel" string="إلغاء المعاملة" type="object"
                            attrs="{'invisible':[('state', '!=', 'draft')]}" class="oe_link cancel-treatment"/>

                    <button name="%(ejad_erp_administrative_communications.ac_operation_report)d" string="طباعة المعاملة" type="action"
                            class="oe_highlight print-treatment"/>
                    <button name="follow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="متابعة" type="object" class="follow-treatment" attrs="{'invisible':[('is_follow', '!=', 1)]}"/>
                    <button name="unfollow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="إلغاء المتابعة" class="unfollow-treatment" type="object" attrs="{'invisible':[('is_follow', '!=', 2)]}"/>

                    <field name="message" style="color:red;" attrs="{'invisible':[('is_ok', '=', True)]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,open,done"/>
                    <field name="state_detailed" invisible="1"/>
                    <field name="assigned_employee_id" invisible="1"/>
                    <field name="is_ok" invisible="1"/>
                    <field name="type" invisible="1"/>
                    <field name="is_department_outbox" invisible="1"/>
                    <field name="user_ids" widget="many2many_tags" invisible="1"/>
                    <field name="is_follow" invisible="1"/>
                    <field name="id" invisible="1"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_operation_history" string="سجل الحركات" icon="fa-bar-chart-o">
                        </button>
                        <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="ejad_erp_administrative_communications.group_operation_archive">
                            <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                        </button>
                        <button name="mark_as_read" type="object" class="oe_stat_button"
                                icon="fa-check-square-o" attrs="{'invisible':[('type', '!=', 'generalization')]}">
                            <field name="is_read" widget="boolean_button" options="{'terminology': {'string_true':'مقروء',
                                                                                                    'hover_true':'Restore',
                                                                                                    'string_false':'غير مقروء',
                                                                                                    'hover_false':'قراءة'}}"/>
                        </button>
                    </div>
                    <h1 class="mt0">
                        <spam string="معاملة مسودة" attrs="{'invisible': [('name', '!=', False)]}"/>
                        <div  attrs="{'invisible': [('name', '=', False)]}">
                            <field name="name" class="oe_inline" readonly="1"/>
                        </div>
                    </h1>
                    <group>
                        <group>
                            <field name="marking" readonly="1"/>
                            <field name="external_partner_ids" widget="many2many_tags" attrs="{'invisible': [('external_partner_ids', '=', False)]}"/>
                            <field name="date"/>
                            <field name="subject"/>
                            <field name="nature" widget="selection"/>


                            <field name="linked_id" domain="[('id', '!=', id)]" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}"/>
                            <field name="deadline_date"/>
                            <!--<field name="country_id" options="{'no_create': True, 'no_open': True}"/>-->
                            <field name="department_sequence"/>
                            <field name="incoming_date"/>
                            <field name="incoming_no"/>
                            <field name="dest" string="جهة الإحالة"/>

                            <field name="priority" widget="priority"/>
                            <field name="security" widget="priority"/>
                            <field name="auditor" attrs="{'invisible':[('dest','!=','auditor')]}"/>
                            <field name="partner_id" attrs="{'invisible':[('dest','!=','beneficiary')]}"/>
                            <field name="employee_id" attrs="{'invisible':[('dest','!=','emp')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="department_ids" attrs="{'invisible':[('dest','!=','dept')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="ident_no" attrs="{'invisible':[('dest','not in',['auditor','emp','beneficiary'])]}"/>
                            <field name="receive_method" widget="selection" attrs="{'invisible': [('receive_method', '=', False)]}"/>
                            <field name="show_attachment" invisible="1"/>
                        </group>
                        <group>
                            <field name="operation_attachment" widget="pdf_viewer" nolabel="1" attrs="{'invisible':[('show_attachment','!=',True),('id','!=',False)]}"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="المعاملات ذات العلاقة" groups="ejad_erp_administrative_communications.access_related_operations">
                            <field nolabel="1" name="linked_operation_ids" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}" groups="ejad_erp_administrative_communications.access_related_operations"/>
                        </page>
                        <page string="نص الموضوع">
                            <field name="details" widget="html"/>
                        </page>

                        <page string="الإدارات/ الأقسام" attrs="{'invisible':[('dest','!=','dept')]}">
                            <field name="department_ids"
                                   domain="[('is_ac_eligible','=',True)]" attrs="{'invisible':[('dest','!=','dept')]}">
                                <tree create="true" edit="true" delete="true">
                                    <field name="code"/>
                                    <field name="display_name"/>
                                    <field name="parent_id"/>
                                    <field name="manager_id"/>
                                </tree>
                            </field>
                        </page>

                        <page string="الإفادة">
                            <field name="is_editing_benefit_note" invisible="1"/>
                            <field name="benefit_note" widget="html" attrs="{'readonly':[('is_editing_benefit_note', '!=', True)]}"/>
                        </page>

                        <page string="معلومات أخرى">
                            <group>
                                <group>
                                    <field name="directing" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_no" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="subject_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="is_editing_other_info" invisible="1"/>
                                </group>
                                <group>
                                    <field name="directing_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="deadline_state"/>
                                </group>
                            </group>
                        </page>

                        <page string="المرفقات" attrs="{'invisible':[('type', '=', 'generalization')]}">
                            <group>
                                <field name="attachments_no"/>
                            </group>
                            <field name="attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="المرفقات" attrs="{'invisible':[('type', '!=', 'generalization')]}">
                            <field name="generalization_attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="التعليقات">
                            <field name="comment_ids">
                                <tree create="false">
                                    <field name="date"/>
                                    <field name="user_id"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="date"/>
                                        <field name="user_id"/>
                                        <field name="comment" widget="html"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="الملاحظات">
                            <field name="notes"/>
                        </page>
                        <page string="مدخل البيانات" groups="ejad_erp_administrative_communications.group_operation_settings">
                            <br/>
                            <group attrs="{'invisible':[('id','!=',False)]}">
                                <field name="create_employee_id" string="الموظف" options="{'no_create': True, 'no_open': True}"/>
                            </group>
                            <field name="emp_image" widget="image" class="oe_avatar"/>
                            <div class="oe_title">
                                <h1>
                                    <field name="emp_name"/>
                                </h1>
                                <div class="o_row">
                                    <field name="emp_department"/>
                                </div>
                            </div>
                            <group>
                                <group>
                                    <field name="emp_email" widget="email"/>
                                </group>
                                <group>
                                    <field name="date_create"/>
                                </group>
                            </group>
                        </page>
                        <page string="المُطّلعين على المعاملة" groups="ejad_erp_administrative_communications.access_users_viewer">
                            <field name="seen_users_ids">
                                <tree>
                                    <field name="user"/>
                                    <field name="seen_date_time"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="department_inbox_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree decoration-info="priority=='1'" decoration-warning="priority=='2'"
                  decoration-danger="priority=='3'" create="false" class="tree_no_open">
                <field name="name"/>
                <!--<field name="department_sequence"/>-->
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags"/>
                <!--<field name="incoming_date"/>-->
                <field name="incoming_no"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="marking" readonly="1"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
                <button name="show_operation" type="object" icon="fa-external-link" string="عرض المعاملة"/>
            </tree>
        </field>
    </record>

    <record id="action_ac_operation_department_in" model="ir.actions.act_window">
        <field name="name">وارد الادارة</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="limit">80</field>
        <field name="view_mode">tree,form,kanban</field>
        <field name="context">{'incoming_operation_check':True}</field>
        <field name="domain">[('is_department_inbox','=',True)]</field>
    </record>
    <record id="child_department_inbox_action_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="view_id" ref="department_inbox_tree"/>
        <field name="act_window_id" ref="action_ac_operation_department_in"/>
    </record>
    <record id="child_department_inbox_action_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="view_id" ref="department_inbox_form"/>
        <field name="act_window_id" ref="action_ac_operation_department_in"/>
    </record>


    <!-- ############################# صادر الإدارة ############################# -->

    <record id="department_outbox_form" model="ir.ui.view">
        <field name="name">ac.operation.form</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_save_action)d" string="حفظ المعاملة" type="action"
                            attrs="{'invisible': [('state', '!=', 'open')]}" class="oe_highlight save-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_transfer_action)d"
                            string="إحالة المعاملة" type="action" class="oe_highlight redirect-treatment" attrs="{'invisible':[('state', '=', 'done')]}"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_comment_action)d" string="إضافة تعليق"
                            type="action" attrs="{'invisible':[('state', '!=', 'open')]}" class="add-comment"/>
                    <button name="apply_marking" string="التأشير على المعاملة" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_marking" class="sign-treatment"/>

                    <button name="apply_dismarking" string="الغاء التأشير" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','!=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_dis_marking" class="cancel-sign"/>
                    <button name="action_cancel" string="إلغاء المعاملة" type="object"
                            attrs="{'invisible':[('state', '!=', 'draft')]}" class="oe_link cancel-treatment"/>

                    <button name="%(ejad_erp_administrative_communications.ac_operation_report)d" string="طباعة المعاملة" type="action"
                            class="oe_highlight print-treatment"/>
                    <button name="follow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="متابعة" type="object" class="follow-treatment" attrs="{'invisible':[('is_follow', '!=', 1)]}"/>
                    <button name="unfollow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="إلغاء المتابعة" class="unfollow-treatment" type="object" attrs="{'invisible':[('is_follow', '!=', 2)]}"/>

                    <field name="state" widget="statusbar" statusbar_visible="draft,open,done"/>
                    <field name="type" invisible="1"/>
                    <field name="is_department_outbox" invisible="1"/>
                    <field name="user_ids" widget="many2many_tags" invisible="1"/>
                    <field name="is_follow" invisible="1"/>
                    <field name="id" invisible="1"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_operation_history" string="سجل الحركات" icon="fa-bar-chart-o">
                        </button>
                        <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="ejad_erp_administrative_communications.group_operation_archive">
                            <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                        </button>
                    </div>
                    <h1 class="mt0">
                        <spam string="معاملة مسودة" attrs="{'invisible': [('name', '!=', False)]}"/>
                        <div  attrs="{'invisible': [('name', '=', False)]}">
                            <field name="name" class="oe_inline" readonly="1"/>
                        </div>
                    </h1>
                    <group>
                        <group>
                            <field name="marking" readonly="1"/>
                            <field name="external_partner_ids" string="جهة الصادر" widget="many2many_tags" attrs="{'invisible': [('external_partner_ids', '=', False)]}"/>
                            <field name="date"/>
                            <field name="subject"/>
                            <field name="nature" widget="selection"/>


                            <field name="linked_id" domain="[('id', '!=', id)]" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}"/>
                            <field name="deadline_date"/>
                            <!--<field name="country_id" options="{'no_create': True, 'no_open': True}"/>-->
                            <field name="department_sequence"/>
                            <field name="dest"/>

                            <field name="priority" widget="priority"/>
                            <field name="security" widget="priority"/>
                            <field name="auditor" attrs="{'invisible':[('dest','!=','auditor')]}"/>
                            <field name="partner_id" attrs="{'invisible':[('dest','!=','beneficiary')]}"/>
                            <field name="employee_id" attrs="{'invisible':[('dest','!=','emp')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="department_ids" attrs="{'invisible':[('dest','!=','dept')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="ident_no" attrs="{'invisible':[('dest','not in',['auditor','emp','beneficiary'])]}"/>
                            <field name="receive_method" widget="selection" attrs="{'invisible': [('receive_method', '=', False)]}"/>
                            <field name="show_attachment" invisible="1"/>
                        </group>
                        <group>
                            <field name="operation_attachment" widget="pdf_viewer" nolabel="1" attrs="{'invisible':[('show_attachment','!=',True),('id','!=',False)]}"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="المعاملات ذات العلاقة" groups="ejad_erp_administrative_communications.access_related_operations">
                            <field nolabel="1" name="linked_operation_ids" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}" groups="ejad_erp_administrative_communications.access_related_operations"/>
                        </page>
                        <page string="نص الموضوع">
                            <field name="details" widget="html"/>
                        </page>

                        <page string="الإفادة">
                            <field name="is_editing_benefit_note" invisible="1"/>
                            <field name="benefit_note" widget="html" attrs="{'readonly':[('is_editing_benefit_note', '!=', True)]}"/>
                        </page>

                        <page string="معلومات أخرى">
                            <group>
                                <group>
                                    <field name="directing" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_no" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="subject_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="is_editing_other_info" invisible="1"/>
                                </group>
                                <group>
                                    <field name="directing_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="deadline_state"/>
                                </group>
                            </group>
                        </page>

                        <page string="المرفقات" attrs="{'invisible':[('type', '=', 'generalization')]}">
                            <group>
                                <field name="attachments_no"/>
                            </group>
                            <field name="attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="المرفقات" attrs="{'invisible':[('type', '!=', 'generalization')]}">
                            <field name="generalization_attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="التعليقات">
                            <field name="comment_ids">
                                <tree create="false">
                                    <field name="date"/>
                                    <field name="user_id"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="date"/>
                                        <field name="user_id"/>
                                        <field name="comment" widget="html"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="الملاحظات">
                            <field name="notes"/>
                        </page>
                        <page string="المُطّلعين على المعاملة" groups="ejad_erp_administrative_communications.access_users_viewer">
                            <field name="seen_users_ids">
                                <tree>
                                    <field name="user"/>
                                    <field name="seen_date_time"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="employee_inbox_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree decoration-info="priority=='1'" decoration-warning="priority=='2'"
                  decoration-danger="priority=='3'" create="false" class="tree_no_open">
                <field name="name"/>
                <!--<field name="department_sequence"/>-->
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags" string="جهة الوارد"/>
                <field name="incoming_date"/>
                <field name="incoming_no"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="is_read" groups="ejad_erp_administrative_communications.group_operation_settings"/>
                <field name="marking" readonly="1"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
                <button name="show_operation" type="object" icon="fa-external-link" string="عرض المعاملة"/>
            </tree>
        </field>
    </record>

    <record id="action_ac_operation_in" model="ir.actions.act_window">
        <field name="name">الوارد</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="limit">80</field>
        <field name="view_mode">tree,form,kanban,graph,pivot</field>
        <field name="context">{'incoming_operation_check':True}</field>
        <field name="domain">[('is_employee_inbox', '=', True)]</field>
    </record>
    <record id="child_employee_inbox_action_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="view_id" ref="employee_inbox_tree"/>
        <field name="act_window_id" ref="action_ac_operation_in"/>
    </record>
    <record id="child_employee_inbox_action_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="view_id" ref="employee_inbox_form"/>
        <field name="act_window_id" ref="action_ac_operation_in"/>
    </record>


    <!-- ############################# الصادر ############################# -->

    <record id="employee_outbox_form" model="ir.ui.view">
        <field name="name">ac.operation.form</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_save_action)d" string="حفظ المعاملة" type="action"
                            attrs="{'invisible': ['|',('is_ok', '!=', True),('state', '!=', 'open')]}" class="oe_highlight save-treatment"/>
                    <button name="action_reopen" string="إعادة فتح المعاملة" type="object"
                            attrs="{'invisible': [('state', 'not in', ['done','canceled'])]}"
                            groups="ejad_erp_administrative_communications.access_reopen_operations" class="oe_highlight reopen-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_transfer_action)d"
                            string="إحالة المعاملة" type="action" class="oe_highlight redirect-treatment"
                            attrs="{'invisible':[('state', '=', 'done')]}"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_comment_action)d" string="إضافة تعليق"
                            type="action" attrs="{'invisible':[('state', '!=', 'open')]}" class="add-comment"/>
                    <button name="apply_marking" string="التأشير على المعاملة" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_marking" class="sign-treatment"/>

                    <button name="apply_dismarking" string="الغاء التأشير" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','!=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_dis_marking" class="cancel-sign"/>
                    <button name="action_cancel" string="إلغاء المعاملة" type="object"
                            attrs="{'invisible':[('state', '!=', 'draft')]}" class="oe_link cancel-treatment"/>

                    <button name="%(ejad_erp_administrative_communications.ac_operation_report)d" string="طباعة المعاملة" type="action"
                            class="oe_highlight print-treatment"/>
                    <button name="follow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="متابعة" type="object" class="follow-treatment" attrs="{'invisible':[('is_follow', '!=', 1)]}"/>
                    <button name="unfollow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="إلغاء المتابعة" class="unfollow-treatment" type="object" attrs="{'invisible':[('is_follow', '!=', 2)]}"/>

                    <field name="message" style="color:red;" attrs="{'invisible':['|',('is_ok', '=', True),('id','=',False)]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,open,done"/>
                    <field name="state_detailed" invisible="1"/>
                    <field name="assigned_employee_id" invisible="1"/>
                    <field name="is_ok" invisible="1"/>
                    <field name="id" invisible="1"/>
                    <field name="type" invisible="1"/>
                    <field name="user_ids" widget="many2many_tags" invisible="1"/>
                    <field name="is_follow" invisible="1"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_operation_history" string="سجل الحركات" icon="fa-bar-chart-o">
                        </button>
                        <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="ejad_erp_administrative_communications.group_operation_archive">
                            <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                        </button>
                    </div>
                    <h1 class="mt0">
                        <spam string="معاملة مسودة" attrs="{'invisible': [('name', '!=', False)]}"/>
                        <div  attrs="{'invisible': [('name', '=', False)]}">
                            <field name="name" class="oe_inline" readonly="1"/>
                        </div>
                    </h1>
                    <group>
                        <field name="type_op" widget="radio" attrs="{'invisible':[('id','!=',False)]}"/>
                        <group>
                            <field name="marking" readonly="1"/>
                            <field name="date"/>
                            <field name="subject"/>
                            <field name="nature" widget="selection" domain="[('code','not in',['ac_nature_gn'])]"/>
                            <!--<field name="receive_method" widget="selection"/>-->

                            <field name="linked_id" domain="[('id', '!=', id)]" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}"/>
                            <field name="deadline_date"/>
                            <!--<field name="country_id" options="{'no_create': True, 'no_open': True}"/>-->
                            <field name="department_sequence"/>
                            <field name="dest"/>

                            <field name="priority" widget="priority"/>
                            <field name="security" widget="priority"/>
                            <field name="auditor" attrs="{'invisible':[('dest','!=','auditor')]}"/>
                            <field name="partner_id" attrs="{'invisible':[('dest','!=','beneficiary')]}"/>
                            <field name="employee_id" attrs="{'invisible':[('dest','!=','emp')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="department_ids" attrs="{'invisible':[('dest','!=','dept')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="ident_no" attrs="{'invisible':[('dest','not in',['auditor','emp','beneficiary'])]}"/>
                            <field name="show_attachment" invisible="1"/>
                        </group>
                        <group>
                            <field name="operation_attachment" widget="pdf_viewer" nolabel="1" attrs="{'invisible':[('show_attachment','!=',True),('id','!=',False)]}"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="المعاملات ذات العلاقة" groups="ejad_erp_administrative_communications.access_related_operations">
                            <field nolabel="1" name="linked_operation_ids" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}" groups="ejad_erp_administrative_communications.access_related_operations"/>
                        </page>
                        <page string="نص الموضوع">
                            <field name="details" widget="html"/>
                        </page>

                        <page string="الإدارات/ الأقسام" attrs="{'invisible':[('dest','!=','dept')]}">
                            <field name="department_ids"
                                   domain="[('is_ac_eligible','=',True)]" attrs="{'invisible':[('dest','!=','dept')]}">
                                <tree create="true" edit="true" delete="true">
                                    <field name="code"/>
                                    <field name="display_name"/>
                                    <field name="parent_id"/>
                                    <field name="manager_id"/>
                                </tree>
                            </field>
                        </page>

                        <page string="الإفادة">
                            <field name="is_editing_benefit_note" invisible="1"/>
                            <field name="benefit_note" widget="html" attrs="{'readonly':[('is_editing_benefit_note', '!=', True)]}"/>
                        </page>

                        <page string="معلومات أخرى">
                            <group>
                                <group>
                                    <field name="directing" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_no" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="subject_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="is_editing_other_info" invisible="1"/>
                                </group>
                                <group>
                                    <field name="directing_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="deadline_state"/>
                                </group>
                            </group>
                        </page>

                        <page string="المرفقات" attrs="{'invisible':[('type', '=', 'generalization')]}">
                            <group>
                                <field name="attachments_no"/>
                            </group>
                            <field name="attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="المرفقات" attrs="{'invisible':[('type', '!=', 'generalization')]}">
                            <field name="generalization_attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="التعليقات">
                            <field name="comment_ids">
                                <tree create="false">
                                    <field name="date"/>
                                    <field name="user_id"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="date"/>
                                        <field name="user_id"/>
                                        <field name="comment" widget="html"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="الملاحظات">
                            <field name="notes"/>
                        </page>
                        <page string="مدخل البيانات" groups="ejad_erp_administrative_communications.group_operation_settings">
                            <br/>
                            <group attrs="{'invisible':[('id','!=',False)]}">
                                <field name="create_employee_id" string="الموظف" options="{'no_create': True, 'no_open': True}"/>
                            </group>
                            <field name="emp_image" widget="image" class="oe_avatar"/>
                            <div class="oe_title">
                                <h1>
                                    <field name="emp_name"/>
                                </h1>
                                <div class="o_row">
                                    <field name="emp_department"/>
                                </div>
                            </div>
                            <group>
                                <group>
                                    <field name="emp_email" widget="email"/>
                                </group>
                                <group>
                                    <field name="date_create"/>
                                </group>
                            </group>
                        </page>
                        <page string="المُطّلعين على المعاملة" groups="ejad_erp_administrative_communications.access_users_viewer">
                            <field name="seen_users_ids">
                                <tree>
                                    <field name="user"/>
                                    <field name="seen_date_time"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>

                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="employee_inbox_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree decoration-info="priority=='1'" decoration-warning="priority=='2'"
                  decoration-danger="priority=='3'" create="false" class="tree_no_open">
                <field name="name"/>
                <!--<field name="department_sequence"/>-->
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags" string="جهة الوارد"/>
                <field name="incoming_date"/>
                <field name="incoming_no"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="is_read" groups="ejad_erp_administrative_communications.group_operation_settings"/>
                <field name="marking" readonly="1"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
                <button name="show_operation" type="object" icon="fa-external-link" string="عرض المعاملة"/>
            </tree>
        </field>
    </record>

    <record id="action_ac_operation_in" model="ir.actions.act_window">
        <field name="name">الوارد</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="limit">80</field>
        <field name="view_mode">tree,form,kanban</field>
        <field name="context">{'incoming_operation_check':True}</field>
        <field name="domain">[('is_employee_inbox', '=', True)]</field>
    </record>
    <record id="child_employee_inbox_action_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="view_id" ref="employee_inbox_tree"/>
        <field name="act_window_id" ref="action_ac_operation_in"/>
    </record>
    <record id="child_employee_inbox_action_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="view_id" ref="employee_inbox_form"/>
        <field name="act_window_id" ref="action_ac_operation_in"/>
    </record>



    <record id="employee_outbox_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree decoration-info="priority=='1'" decoration-warning="priority=='2'"
                  decoration-danger="priority=='3'" class="tree_no_open">
                <field name="name"/>
                <!--<field name="department_sequence"/>-->
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="marking" readonly="1"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
                <button name="show_operation" type="object" icon="fa-external-link" string="عرض المعاملة"/>
            </tree>
        </field>
    </record>

    <record id="action_ac_operation_out" model="ir.actions.act_window">
        <field name="name">الصادر</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="limit">80</field>
        <field name="view_mode">tree,form,kanban,graph,pivot</field>
        <field name="domain">[('is_employee_outbox', '=', True)]</field>
        <field name="context">{'outgoing_operation_check':True, 'default_is_employee_outbox' : True,'default_state_detailed' : 'employee_outbox'}</field>
    </record>
    <record id="child_employee_outbox_action_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="view_id" ref="employee_outbox_tree"/>
        <field name="act_window_id" ref="action_ac_operation_out"/>
    </record>
    <record id="child_employee_outbox_action_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="view_id" ref="employee_outbox_form"/>
        <field name="act_window_id" ref="action_ac_operation_out"/>
    </record>


    <!--Kanban view-->

    <record model="ir.ui.view" id="ac_operation_kanban">
        <field name="name">ac.operation.kanban</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile kanban_no_open" create="false">
                <field name="name"/>
                <field name="external_partner_ids" widget="many2many_tags"/>
                <field name="department_id"/>
                <field name="date"/>
                <field name="priority"/>
                <field name="security"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card">
                            <div class="o_kanban_record_top">
                                <div class="o_kanban_record_headings">
                                    <strong class="o_kanban_record_title"><span><t t-esc="record.name.value"/></span></strong><br/>
                                    <button name="show_operation" type="object" class="btn btn-primary">
                                        <span>عرض المعاملة</span>
                                    </button>
                                </div>
                                <div class="oe_kanban_bottom_right text-muted">
                                    <span><t t-esc="record.date.value"/></span>
                                </div>

                            </div>
                            <div class="o_kanban_record_bottom">
                                <div class="oe_kanban_bottom_left text-muted">
                                    <span>
                                        <!--<t t-esc="record.external_party_id.value"/>-->
                                        <t t-foreach="record.external_partner_ids" t-as="partner">
                                            <t t-esc="partner.value"/>
                                        </t>

                                    </span><br/>
                                </div>
                                <div class="oe_kanban_bottom_left text-muted">
                                    <span><t t-esc="record.department_id.value"/></span>
                                </div>
                                <div class="oe_kanban_bottom_right">
                                    <span class="pull-right text-right">
                                        <field name="priority" widget="priority"/>
                                        <field name="security" widget="priority"/>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="action_ac_operation_archive" model="ir.actions.act_window">
        <field name="name">أرشيف المعاملات</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="limit">80</field>
        <field name="view_mode">tree,form,kanban,graph,pivot</field>
        <field name="domain">[('active','=','False)]</field>
    </record>
<!-- odoo 13 -->
<!--    <act_window-->
<!--            id="action_wiz_ac_operation_transfer"-->
<!--            name="إحالة"-->
<!--            res_model="wiz.ac.operation.transfer"-->
<!--            src_model="ac.operation"-->
<!--            view_mode="form"-->
<!--            target="new"-->
<!--            key2="client_action_multi"-->
<!--        />-->

    <record id="ac_following_operation_form" model="ir.ui.view">
        <field name="name">ac.operation.form</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <form create="false">
                <header>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_save_action)d" string="حفظ المعاملة" type="action"
                            attrs="{'invisible': ['|',('state_detailed', 'not in', ['global_inbox']),('state', '!=', 'open')]}" class="oe_highlight save-treatment"/>
                    <button name="action_reopen" string="إعادة فتح المعاملة" type="object"
                            attrs="{'invisible': [('state', 'not in', ['done','canceled'])]}"
                            groups="ejad_erp_administrative_communications.access_reopen_operations" class="oe_highlight redirect-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_transfer_action)d" string="إحالة المعاملة" type="action"
                            attrs="{'invisible':['|',('state_detailed', 'not in', ['global_inbox']),('state', '=', 'done')]}" context="{'default_department_id':department_ids}" class="oe_highlight redirect-treatment"/>
                    <button name="%(ejad_erp_administrative_communications.ac_operation_comment_action)d" string="إضافة تعليق"
                            attrs="{'invisible':[('id', '=', False)]}" type="action" class="add-comment"/>

                    <button name="apply_marking" string="التأشير على المعاملة" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_marking" class="sign-treatment"/>

                    <button name="apply_dismarking" string="الغاء التأشير" type="object"
                            attrs="{'invisible':['|', ('state', '=', 'draft'),('marking','!=', True)]}"
                            groups="ejad_erp_administrative_communications.access_allow_dis_marking" class="cancel-sign"/>

                    <button name="action_cancel" string="إلغاء المعاملة" type="object"
                            attrs="{'invisible':[('state', '!=', 'draft')]}" class="oe_link cancel-treatment"/>

                    <button name="%(ejad_erp_administrative_communications.ac_operation_report)d" string="طباعة المعاملة" type="action"
                            class="oe_highlight print-treatment"/>

                    <button name="follow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="متابعة" type="object" class="follow-treatment" attrs="{'invisible':[('is_follow', '!=', 1)]}"/>
                    <button name="unfollow_operation" groups="ejad_erp_administrative_communications.access_following_operations"
                            string="إلغاء المتابعة" class="unfollow-treatment" type="object" attrs="{'invisible':[('is_follow', '!=', 2)]}"/>
                    <field name="message" style="color:red;" attrs="{'invisible':[('state_detailed', 'in', ['global_inbox'])]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,open,done"/>
                    <field name="state_detailed" invisible="1"/>
                    <field name="type" invisible="1"/>
                    <field name="department_ids" invisible="1" options="{'no_create': True, 'no_open': True}"/>
                    <field name="is_editing_benefit_note" invisible="1"/>
                    <field name="is_follow" invisible="1"/>
                    <field name="user_ids" widget="many2many_tags" invisible="1"/>
                    <field name="id" invisible="1"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="object" name="action_operation_history" string="سجل الحركات" icon="fa-bar-chart-o">
                        </button>
                        <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="ejad_erp_administrative_communications.group_operation_archive">
                            <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                        </button>
                    </div>
                    <h1 class="mt0">
                        <spam string="معاملة مسودة" attrs="{'invisible': [('name', '!=', False)]}"/>
                        <div  attrs="{'invisible': [('name', '=', False)]}">
                            <field name="name" class="oe_inline" readonly="1"/>
                        </div>
                    </h1>
                    <group>
                        <group>
                            <field name="marking" readonly="1"/>
                            <field name="external_partner_ids" widget="many2many_tags" domain="[('is_ac_eligible','=',True)]" context="{'default_is_ac_eligible':True}"/>
                            <field name="date"/>
                            <field name="subject"/>
                            <field name="nature" widget="selection" domain="[('code','not in',['ac_nature_or','ac_nature_gn'])]"/>
                            <field name="receive_method" widget="selection"/>

                            <field name="linked_id" domain="[('id', '!=', id)]" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}"/>
                            <field name="deadline_date"/>
                            <!--<field name="country_id" options="{'no_create': True, 'no_open': True}"/>-->
                            <field name="department_sequence"/>
                            <field name="incoming_date"/>
                            <field name="incoming_no"/>
                            <field name="dest" string="جهة الإحالة"/>

                            <field name="priority" widget="priority"/>
                            <field name="security" widget="priority"/>
                            <field name="auditor" attrs="{'invisible':[('dest','!=','auditor')]}"/>
                            <field name="partner_id" attrs="{'invisible':[('dest','!=','beneficiary')]}"/>
                            <field name="employee_id" attrs="{'invisible':[('dest','!=','emp')]}" options="{'no_create': True, 'no_open': True}"/>
                            <field name="ident_no" attrs="{'invisible':[('dest','not in',['auditor','emp','beneficiary'])]}"/>
                            <field name="show_attachment" invisible="1"/>
                        </group>
                        <group>
                            <field name="operation_attachment" widget="pdf_viewer" nolabel="1" attrs="{'invisible':[('show_attachment','!=',True),('id','!=',False)]}"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="المعاملات ذات العلاقة" groups="ejad_erp_administrative_communications.access_related_operations">
                            <field nolabel="1" name="linked_operation_ids" context="{'tree_view_ref': 'ejad_erp_administrative_communications.ac_operation_tree'}" groups="ejad_erp_administrative_communications.access_related_operations"/>
                        </page>
                        <page string="نص الموضوع">
                            <field name="details" widget="html"/>
                        </page>

                        <page string="الإدارات/ الأقسام" attrs="{'invisible':[('dest','!=','dept')]}">
                            <field name="department_ids"
                                   domain="[('is_ac_eligible','=',True)]" attrs="{'invisible':[('dest','!=','dept')]}">
                                <tree create="true" edit="true" delete="true">
                                    <field name="code"/>
                                    <field name="display_name"/>
                                    <field name="parent_id"/>
                                    <field name="manager_id"/>
                                </tree>
                            </field>
                        </page>
                        <page string="الإفادة">

                            <field name="benefit_note" widget="html" attrs="{'readonly':[('is_editing_benefit_note', '!=', True)]}"/>
                        </page>
                        <page string="معلومات أخرى">
                            <group>
                                <group>
                                    <field name="directing" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_no" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="subject_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="is_editing_other_info" invisible="1"/>
                                </group>
                                <group>
                                    <field name="directing_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="outbound_date" attrs="{'readonly':[('is_editing_other_info', '!=', True)]}"/>
                                    <field name="deadline_state"/>
                                </group>
                            </group>
                        </page>

                        <page string="المرفقات" attrs="{'invisible':[('type', '=', 'generalization')]}">
                            <group>
                                <field name="attachments_no"/>
                            </group>
                            <field name="attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="المرفقات" attrs="{'invisible':[('type', '!=', 'generalization')]}">
                            <field name="generalization_attachment_ids">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="attachment_filename" invisible="1"/>
                                    <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="name"/>
                                        <field name="attachment_filename" invisible="1"/>
                                        <field widget="binary" height="64" name="attachment_id" filename="attachment_filename"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="التعليقات">
                            <field name="comment_ids">
                                <tree create="false">
                                    <field name="date"/>
                                    <field name="user_id"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="date"/>
                                        <field name="user_id"/>
                                        <field name="comment" widget="html"/>
                                    </group>
                                </form>
                            </field>
                        </page>
                        <page string="الملاحظات">
                            <field name="notes"/>
                        </page>
                        <page string="مدخل البيانات" groups="ejad_erp_administrative_communications.group_operation_settings">
                            <br/>
                            <group attrs="{'invisible':[('id','!=',False)]}">
                                <field name="create_employee_id" string="الموظف" options="{'no_create': True, 'no_open': True}"/>
                            </group>
                            <field name="emp_image" widget="image" class="oe_avatar"/>
                            <div class="oe_title">
                                <h1>
                                    <field name="emp_name"/>
                                </h1>
                                <div class="o_row">
                                    <field name="emp_department"/>
                                </div>
                            </div>
                            <group>
                                <group>
                                    <field name="emp_email" widget="email"/>
                                </group>
                                <group>
                                    <field name="date_create"/>
                                </group>
                            </group>
                        </page>
                        <page string="المُطّلعين على المعاملة" groups="ejad_erp_administrative_communications.access_users_viewer">
                            <field name="seen_users_ids">
                                <tree>
                                    <field name="user"/>
                                    <field name="seen_date_time"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" domain="[('message_type','=','mail')]" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>


    <record id="ac_operation_following_tree" model="ir.ui.view">
        <field name="name">ac.operation.tree</field>
        <field name="model">ac.operation</field>
        <field name="arch" type="xml">
            <tree decoration-info="priority=='1'" decoration-warning="priority=='2'"
                  decoration-danger="priority=='3'" class="tree_no_open" create="false" edit="false">
                <field name="name"/>
                <!--<field name="department_sequence"/>-->
                <field name="date"/>
                <field name="subject"/>
                <field name="external_partner_ids" widget="many2many_tags"/>
                <!--<field name="incoming_date"/>-->
                <field name="incoming_no"/>
                <field name="state"/>
                <field name="priority"/>
                <field name="security"/>
                <field name="marking" readonly="1"/>
                <field name="user_ids" widget="many2many_tags" invisible="1"/>
                <button name="show_operation" type="object" icon="fa-external-link" string="عرض المعاملة"/>
            </tree>
        </field>
    </record>

    <record id="action_ac_operation_following" model="ir.actions.act_window">
        <field name="name">المعاملات المفاضلة</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ac.operation</field>

        <field name="view_mode">tree,form,kanban,graph,pivot</field>
        <field name="domain">[('user_ids','in',[uid])]</field>
        <field name="limit">80</field>
    </record>

    <record id="child_following_action_tree" model="ir.actions.act_window.view">
        <field name="view_mode">tree</field>
        <field name="view_id" ref="ac_operation_following_tree"/>
        <field name="act_window_id" ref="action_ac_operation_following"/>
    </record>
    <record id="child_following_action_form" model="ir.actions.act_window.view">
        <field name="view_mode">form</field>
        <field name="view_id" ref="ac_following_operation_form"/>
        <field name="act_window_id" ref="action_ac_operation_following"/>
    </record>


    <menuitem id="ac_menu" name="الاتصالات الادارية" web_icon="ejad_erp_administrative_communications,static/src/img/ac_icon_green.png" groups="ejad_erp_administrative_communications.group_administrative_communications_menu"/>

    <menuitem id="ac_operation_inbox_outbox" name="الصادر و الوارد" parent="ac_menu" sequence="1"/>
    <menuitem id="menu_following_operation" name="المعاملات المفضلة"
              parent="ac_operation_inbox_outbox" action="action_ac_operation_following"
              groups="ejad_erp_administrative_communications.access_following_operations" sequence="-1"/>
    <menuitem id="ac_operation_general_in" name="الوارد العام"
              parent="ac_operation_inbox_outbox" action="action_ac_operation_in_general"
              groups="ejad_erp_administrative_communications.group_general_incoming" sequence="1"/>
    <menuitem id="ac_operation_general_out" name="الصادر العام"
              parent="ac_operation_inbox_outbox" action="action_ac_operation_out_general"
              groups="ejad_erp_administrative_communications.group_general_outgoing" sequence="2"/>
    <menuitem id="ac_operation_department_in" name="وارد الادارة" parent="ac_operation_inbox_outbox" action="action_ac_operation_department_in"
              groups="ejad_erp_administrative_communications.group_department_incoming" sequence="3"/>
    <menuitem id="ac_operation_department_out" name="صادر الادارة" parent="ac_operation_inbox_outbox" action="action_ac_operation_department_out"
              groups="ejad_erp_administrative_communications.group_department_outgoing" sequence="4"/>
    <menuitem id="ac_operation_in" name="الوارد" parent="ac_operation_inbox_outbox" action="action_ac_operation_in" sequence="5"/>
    <menuitem id="ac_operation_out" name="الصادر" parent="ac_operation_inbox_outbox" action="action_ac_operation_out" sequence="6"/>
    <menuitem id="ac_archive_operation" name="أرشيف المعاملات" parent="ac_operation_inbox_outbox" action="action_ac_operation_archive" sequence="7"/>
    <!--<menuitem id="ac_operation_letters" name="الخطابات" parent="ac_menu" sequence="3" action="action_ac_operation_archive"/> &lt;!&ndash; TODO  &ndash;&gt;-->

</odoo>